var $parcel$global=globalThis,$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire75f2;null==parcelRequire&&((parcelRequire=function(t){if(t in $parcel$modules)return $parcel$modules[t].exports;if(t in $parcel$inits){var e=$parcel$inits[t];delete $parcel$inits[t];var n={id:t,exports:{}};return $parcel$modules[t]=n,e.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){$parcel$inits[t]=e},$parcel$global.parcelRequire75f2=parcelRequire);var parcelRegister=parcelRequire.register;parcelRegister("epNRB",function(module,exports){var $h6ark=parcelRequire("h6ark"),$k4QTz=parcelRequire("k4QTz");let HAS_MARKETPLACE_BEEN_RENDERED=!1,MARKETPLACE_URL="https://raw.githubusercontent.com/Eth0s-Group/Z2-Marketplace/main/market.json",APP_REPO=document.querySelector("#app_repo"),MODAL_BODY=APP_REPO.querySelector(".modal-body"),z2_apps=[];function proxy(t){return`https://z2-liberator-cors-proxy.eth0s.dev/corsproxy/?apiurl=${encodeURIComponent(t)}`}async function update_apps(){console.log(z2_apps=(await (0,$h6ark.godo)("pm list packages",!1,!0)).stdout.replaceAll("package:","").split("\n"))}async function installer(btn){btn.setAttribute("disabled","true"),btn.textContent="Installing dependencies...";let dependencies=eval(btn.getAttribute("data-deps"))||[];for(let dep of(console.log(dependencies),dependencies))console.log(dep),z2_apps.includes(dep)||await installer(document.getElementById("install_"+dep));btn.textContent="Downloading...";let blobby=null;try{blobby=await (await fetch(proxy(btn.getAttribute("data-url")))).blob()}catch(e){console.error(e),btn.textContent="Error downloading :(";return}btn.textContent="Installing app...";try{await (0,$h6ark.install_app)(blobby)}catch(e){console.error(e),btn.textContent="Error installing :(";return}if("undefined"!=btn.getAttribute("data-postinstall")){btn.textContent="Running post-install...";try{await (0,$h6ark.godo)(btn.getAttribute("data-postinstall"))}catch(e){console.error(e),btn.textContent="Error running post-install :(";return}}dependencies.includes("moe.shizuku.privileged.api")&&(btn.textContent="Attempting to start Shizuku to make your life easier...",(0,$h6ark.godo)("sh /sdcard/Android/data/moe.shizuku.privileged.api/start.sh")),update_apps(),btn.textContent="Installed!"}async function render_marketplace(){try{await update_apps()}catch(t){console.error(t),MODAL_BODY.textContent="Unable to communicate with Z2.  Please connect Z2 to use the marketplace.";return}let t=await (await fetch(MARKETPLACE_URL)).json();for(let e of(APP_REPO.querySelector(".modal-header").querySelector("h1").textContent=t.name,MODAL_BODY.innerHTML="",APP_REPO.querySelector(".modal-dialog").style.maxWidth="100%",Object.keys(t.apps))){let n=t.apps[e],r=document.createElement("div");r.style.borderBottom="medium solid gray",r.style.marginBottom="22px";let a=document.createElement("div"),o=document.createElement("div"),l=document.createElement("img");l.src=n.icon,l.style.height="32px",l.style.width="32px",a.appendChild(l);let i=document.createElement("button");i.classList.add("btn","btn-primary"),i.id="install_"+e,i.setAttribute("data-id",e),i.setAttribute("data-url",n.downloadUrl),i.setAttribute("data-deps",JSON.stringify(n.dependencies)),i.setAttribute("data-postinstall",n.postinstall),i.addEventListener("click",()=>{installer(i)}),i.textContent=z2_apps.includes(e)?"Reinstall/Update":"Install",a.appendChild(i),r.appendChild(a);let d=document.createElement("h3");d.textContent=n.name,o.appendChild(d);let s=document.createElement("pre");s.textContent=n.description,o.appendChild(s);let c=document.createElement("a");c.textContent=n.attribution.name,c.href=n.attribution.link,c.target="_blank",o.appendChild(c),r.appendChild(o),MODAL_BODY.appendChild(r)}HAS_MARKETPLACE_BEEN_RENDERED=!0}document.querySelector("#app_repo_launcher").addEventListener("click",()=>{HAS_MARKETPLACE_BEEN_RENDERED||render_marketplace(),new $k4QTz.Modal(document.querySelector("#app_repo")).show()}),document.querySelector("#refresh_repo").addEventListener("click",render_marketplace)}),parcelRequire("epNRB");
//# sourceMappingURL=index.d5692bd3.js.map
