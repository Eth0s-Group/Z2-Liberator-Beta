function e(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var t=globalThis,r={},i={},n=t.parcelRequire75f2;null==n&&((n=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},t.parcelRequire75f2=n);var a=n.register;a("h6ark",function(t,r){e(t.exports,"pair_device",()=>S),e(t.exports,"select_existing",()=>x),e(t.exports,"get_autoconnect",()=>I),e(t.exports,"connect_device",()=>T),e(t.exports,"disconnect",()=>E),e(t.exports,"set_autoconnect",()=>k),e(t.exports,"monitor_usb",()=>R),e(t.exports,"exploit_gabb",()=>P),e(t.exports,"godo",()=>D),e(t.exports,"install_app",()=>N),e(t.exports,"send_to_device",()=>F),n("iuptw");var i=n("dGdCH"),a=n("aI8PJ"),s=n("jhyqS");n("27oor");var o=n("4uv4T"),l=n("aIHw7"),c=n("23OH0");let u=document.querySelector("#konsole"),d=new s.default;console.log("hi friend!"),B(navigator.usb);let h=a.AdbDaemonWebUsbDeviceManager.BROWSER;if(h)B("Yay, you have WebUSB!");else{alert("WebUSB is not supported in this browser!\nWe need WebUSB in order to function.\nPlease try again with Google Chrome.");return}let f=null,p=null,b=null,w=null,g=null,y=null,m=localStorage.autoconnect_enabled||"true";async function S(){await h.requestDevice({filters:[{...i.ADB_DEFAULT_DEVICE_FILTER,vendorId:6610,productId:1106}]}),await A()}async function v(){return p=await h.getDevices([{...i.ADB_DEFAULT_DEVICE_FILTER,vendorId:6610,productId:1106}])}function x(e){if(console.log(f=p.filter(t=>t.serial==e)),f.length<1){f=null;return}f=f[0],I()&&T()}async function E(){if(!f){B("No device connected!");return}try{await w.close()}catch(e){B("Error when closing adb"),console.error(e)}B("ADB session closed"),w=null;try{await f.raw.close()}catch(e){B("Error when closing connection"),console.error(e)}B("Connection closed"),b=null,f=null,y&&await C(),g&&g()}async function A(){return await v(),f&&p.filter(e=>e.serial==f.serial).length<1&&(f=null),console.log(p),!f&&I()&&p.length>0&&(f=p[0],await T(),g&&g()),y&&await C(),p}function k(e){m=e=""+e,localStorage.autoconnect_enabled=e}function I(){return"true"==m}function R(e,t){y=e,g=t,navigator.usb.addEventListener("connect",()=>{B("Connect event received, updating devices..."),A()}),navigator.usb.addEventListener("disconnect",()=>{B("Disconnect event received, updating devices..."),A()}),B("Checking devices due to start..."),A()}async function C(){let e=y;for(let t of(p||await v(),e.innerHTML='<option value="null">No device</option>',p)){let r=document.createElement("option");r.textContent=`${t.raw.productName}	${t.raw.manufacturerName}	${t.serial}`,r.value=t.serial,e.appendChild(r)}f?e.value=f.serial:e.value="null"}async function T(){if(console.log("connect dev"),!f){console.log("Device is null"),alert("Device is null");return}b=await f.connect(),B("Device connection opened...");let e=await (0,l.AdbDaemonTransport).authenticate({serial:f.serial,connection:b,credentialStore:d});B("ADB transport opened..."),w=new o.Adb(e),B("ADB connection created!"),B("Android version: "+await w.getProp("ro.build.version.release")),g&&g()}async function P(){for(let e of(await D("am switch-user 0"),(await D("pm list users")).stdout.matchAll(/(?<uid>\d+):MaintenanceModeUser:/g)))e.groups.uid&&await D("pm remove-user "+e.groups.uid);await D("pm disable-user --user 0 com.gabb.packageupdater"),B("Exploited (if no errors above, lol)!")}async function N(e,t){t||(t="current"),B("Acquiring sync...");let r=await w.sync();B("Sending APK..."),await r.write({filename:"/data/local/tmp/temp.apk",file:e.stream()}),r.dispose(),B("APK sent!");B("Installing...");let i=(await D("pm install-create --user "+t)).stdout.split("[")[1].split("]")[0];await D(`pm install-write ${i} tomato /data/local/tmp/temp.apk`),await D(`pm install-commit ${i}`),await w.rm("/data/local/tmp/temp.apk")}async function F(e){B("Acquiring sync...");let t=await w.sync();B("Sending..."),await t.write({filename:"/sdcard/Download/"+e.name,file:e.stream()}),await t.dispose(),B("Sent!")}let D=async function(e,t,r){let i=await w.subprocess.spawnAndWait(e,{protocols:[c.AdbSubprocessShellProtocol]});if(i.stderr&&(r||B(i.stderr),!t))throw i.stderr;return r||B(i.stdout),i};function B(e){return u?(u.textContent+=`[${new Date().toLocaleString()}] ${e}
`,u.scrollTo(0,u.scrollHeight)):console.log(e),e}}),a("iuptw",function(t,r){e(t.exports,"ADB_DEFAULT_DEVICE_FILTER",()=>n("dGdCH").ADB_DEFAULT_DEVICE_FILTER),e(t.exports,"AdbDaemonWebUsbDeviceManager",()=>n("aI8PJ").AdbDaemonWebUsbDeviceManager),n("dGdCH"),n("aI8PJ"),n("byTpg"),n("7wgv6")}),a("dGdCH",function(t,r){e(t.exports,"ADB_DEFAULT_DEVICE_FILTER",()=>h),e(t.exports,"AdbDaemonWebUsbDevice",()=>b),n("27oor");var i=n("2lmjj"),a=n("fXuIk");n("7edQJ");var s=n("bwQFm"),o=n("jEctC"),l=n("3Ppgt"),c=n("6NYMu");n("hr1EK");var u=n("j4unN"),d=n("byTpg");let h={classCode:255,subclassCode:66,protocolCode:1};class f{#e;#t;get position(){return this.#t}constructor(e){this.#e=e,this.#t=0}readExactly(e){let t=this.#e.subarray(this.#t,this.#t+e);return this.#t+=e,t}}class p{#r;get device(){return this.#r}#i;get inEndpoint(){return this.#i}#n;get outEndpoint(){return this.#n}#a;get readable(){return this.#a}#s;get writable(){return this.#s}constructor(e,t,r,n){this.#r=e,this.#i=t,this.#n=r;let d=!1,h=new s.DuplexStreamFactory({close:async()=>{try{d=!0,await e.raw.close()}catch{}},dispose:()=>{d=!0,n.removeEventListener("disconnect",f)}});function f(t){t.device===e.raw&&h.dispose().catch(a.unreachable)}n.addEventListener("disconnect",f),this.#a=h.wrapReadable(new c.ReadableStream({pull:async e=>{let t=await this.#o();t?e.enqueue(t):e.close()}},{highWaterMark:0}));let p=r.packetSize-1;this.#s=(0,l.pipeFrom)(h.createWritable(new o.MaybeConsumable.WritableStream({write:async t=>{try{await e.raw.transferOut(r.endpointNumber,t),p&&(t.length&p)==0&&await e.raw.transferOut(r.endpointNumber,u.EMPTY_UINT8_ARRAY)}catch(e){if(d)return;throw e}}})),new i.AdbPacketSerializeStream)}async #o(){try{for(;;){let e=await this.#r.raw.transferIn(this.#i.endpointNumber,this.#i.packetSize);if(24!==e.data.byteLength)continue;let t=new Uint8Array(e.data.buffer),r=new f(t),n=(0,i.AdbPacketHeader).deserialize(r);if(n.magic===(0xffffffff^n.command)){if(0!==n.payloadLength){let e=await this.#r.raw.transferIn(this.#i.endpointNumber,n.payloadLength);n.payload=new Uint8Array(e.data.buffer)}else n.payload=u.EMPTY_UINT8_ARRAY;return n}}}catch(e){if((0,d.isErrorName)(e,"NetworkError")&&(await new Promise(e=>{setTimeout(()=>{e()},100)}),closed))return;throw e}}}class b{#l;#c;#u;get raw(){return this.#u}#d;get serial(){return this.#d}get name(){return this.#u.productName}constructor(e,t=[h],r){this.#u=e,this.#d=(0,d.getSerialNumber)(e),this.#l=t,this.#c=r}async #h(){this.#u.opened||await this.#u.open();let{configuration:e,interface_:t,alternate:r}=(0,d.findUsbAlternateInterface)(this.#u,this.#l);this.#u.configuration?.configurationValue!==e.configurationValue&&await this.#u.selectConfiguration(e.configurationValue),t.claimed||await this.#u.claimInterface(t.interfaceNumber),t.alternate.alternateSetting!==r.alternateSetting&&await this.#u.selectAlternateInterface(t.interfaceNumber,r.alternateSetting);let{inEndpoint:i,outEndpoint:n}=function(e){let t,r;if(0===e.length)throw TypeError("No endpoints given");for(let i of e)switch(i.direction){case"in":if(t=i,r)return{inEndpoint:t,outEndpoint:r};break;case"out":if(r=i,t)return{inEndpoint:t,outEndpoint:r}}if(!t)throw TypeError("No input endpoint found.");if(!r)throw TypeError("No output endpoint found.");throw Error("unreachable")}(r.endpoints);return[i,n]}async connect(){let[e,t]=await this.#h();return new p(this,e,t,this.#c)}}}),a("27oor",function(t,r){e(t.exports,"Adb",()=>n("4uv4T").Adb),e(t.exports,"AdbSubprocessShellProtocol",()=>n("23OH0").AdbSubprocessShellProtocol),e(t.exports,"AdbDaemonTransport",()=>n("aIHw7").AdbDaemonTransport),e(t.exports,"AdbPacketHeader",()=>n("2lmjj").AdbPacketHeader),e(t.exports,"AdbPacketSerializeStream",()=>n("2lmjj").AdbPacketSerializeStream),e(t.exports,"unreachable",()=>n("fXuIk").unreachable),n("4uv4T"),n("bFpy9"),n("chJ24"),n("7gpwK"),n("drR7i"),n("jBeoN"),n("5lBQi")}),a("4uv4T",function(t,r){e(t.exports,"Adb",()=>f),n("7edQJ");var i=n("k61Wg"),a=n("koQVx");n("chJ24");var s=n("5WSZn"),o=n("gequt"),l=n("5jHg5"),c=n("aBc50"),u=n("liel6"),d=n("beA73"),h=n("755W6");class f{transport;get serial(){return this.transport.serial}get maxPayloadSize(){return this.transport.maxPayloadSize}get banner(){return this.transport.banner}get disconnected(){return this.transport.disconnected}get clientFeatures(){return this.transport.clientFeatures}get deviceFeatures(){return this.banner.features}subprocess;power;reverse;tcpip;constructor(e){this.transport=e,this.subprocess=new l.AdbSubprocess(this),this.power=new s.AdbPower(this),this.reverse=new o.AdbReverseCommand(this),this.tcpip=new u.AdbTcpIpCommand(this)}canUseFeature(e){return this.clientFeatures.includes(e)&&this.deviceFeatures.includes(e)}async createSocket(e){return this.transport.connect(e)}async createSocketAndWait(e){let t=await this.createSocket(e);return await t.readable.pipeThrough(new a.TextDecoderStream).pipeThrough(new i.ConcatStringStream)}async getProp(e){return(await this.subprocess.spawnAndWaitLegacy(["getprop",e])).trim()}async rm(e,t){let r=["rm"];if(t?.recursive&&r.push("-r"),t?.force&&r.push("-f"),Array.isArray(e))for(let t of e)r.push((0,d.escapeArg)(t));else r.push((0,d.escapeArg)(e));return r.push("</dev/null"),await this.subprocess.spawnAndWaitLegacy(r)}async sync(){let e=await this.createSocket("sync:");return new c.AdbSync(this,e)}async framebuffer(){return(0,h.framebuffer)(this)}async close(){await this.transport.close()}}}),a("7edQJ",function(t,r){e(t.exports,"BufferedReadableStream",()=>n("bJSM1").BufferedReadableStream),e(t.exports,"ConcatStringStream",()=>n("k61Wg").ConcatStringStream),e(t.exports,"Consumable",()=>n("5Ywqs").Consumable),e(t.exports,"BufferCombiner",()=>n("b5TnZ").BufferCombiner),e(t.exports,"DistributionStream",()=>n("b5TnZ").DistributionStream),e(t.exports,"DuplexStreamFactory",()=>n("bwQFm").DuplexStreamFactory),e(t.exports,"TextDecoderStream",()=>n("koQVx").TextDecoderStream),e(t.exports,"MaybeConsumable",()=>n("jEctC").MaybeConsumable),e(t.exports,"pipeFrom",()=>n("3Ppgt").pipeFrom),e(t.exports,"PushReadableStream",()=>n("fnPEF").PushReadableStream),e(t.exports,"AbortController",()=>n("6NYMu").AbortController),e(t.exports,"ReadableStream",()=>n("6NYMu").ReadableStream),e(t.exports,"TransformStream",()=>n("6NYMu").TransformStream),e(t.exports,"WritableStream",()=>n("6NYMu").WritableStream),e(t.exports,"StructDeserializeStream",()=>n("ebpYL").StructDeserializeStream),e(t.exports,"WrapWritableStream",()=>n("67qk3").WrapWritableStream),n("1QeNb"),n("bJSM1"),n("k61Wg"),n("5Ywqs"),n("b5TnZ"),n("bwQFm"),n("koQVx"),n("4eHDJ"),n("jEctC"),n("3Ppgt"),n("fnPEF"),n("jbstH"),n("6NYMu"),n("ebpYL"),n("1yRYZ"),n("cilb9"),n("cSu3L"),n("67qk3")}),a("1QeNb",function(t,r){e(t.exports,"BufferedTransformStream",()=>l),n("hr1EK");var i=n("9LJSP"),a=n("bJSM1"),s=n("fnPEF"),o=n("6NYMu");class l{#a;get readable(){return this.#a}#s;get writable(){return this.#s}constructor(e){let t;let r=new a.BufferedReadableStream(new s.PushReadableStream(e=>{t=e}));this.#a=new o.ReadableStream({async pull(t){try{let i=await e(r);t.enqueue(i)}catch(e){if(e instanceof i.StructEmptyError){t.close();return}throw e}},cancel:e=>r.cancel(e)}),this.#s=new o.WritableStream({async write(e){await t.enqueue(e)},abort(){t.close()},close(){t.close()}})}}}),a("hr1EK",function(t,r){e(t.exports,"ExactReadableEndedError",()=>n("70dme").ExactReadableEndedError),e(t.exports,"Struct",()=>n("9LJSP").Struct),e(t.exports,"StructEmptyError",()=>n("9LJSP").StructEmptyError),e(t.exports,"SyncPromise",()=>n("6yg6p").SyncPromise),e(t.exports,"EMPTY_UINT8_ARRAY",()=>n("j4unN").EMPTY_UINT8_ARRAY),e(t.exports,"decodeUtf8",()=>n("6Savq").decodeUtf8),e(t.exports,"encodeUtf8",()=>n("6Savq").encodeUtf8),e(t.exports,"placeholder",()=>n("6Savq").placeholder),e(t.exports,"default",()=>n("9LJSP").Struct),n("aF1FJ"),n("9LJSP"),n("6yg6p"),n("3rhZL"),n("6Savq")}),a("aF1FJ",function(t,r){e(t.exports,"StructFieldDefinition",()=>n("hU3mS").StructFieldDefinition),e(t.exports,"StructFieldValue",()=>n("4dyEt").StructFieldValue),e(t.exports,"StructDefaultOptions",()=>n("8j8Qa").StructDefaultOptions),e(t.exports,"ExactReadableEndedError",()=>n("70dme").ExactReadableEndedError),e(t.exports,"isStructValueInit",()=>n("iissA").isStructValueInit),e(t.exports,"STRUCT_VALUE_SYMBOL",()=>n("iissA").STRUCT_VALUE_SYMBOL),e(t.exports,"StructValue",()=>n("iissA").StructValue),n("hU3mS"),n("4dyEt"),n("8j8Qa"),n("70dme"),n("iissA")}),a("hU3mS",function(t,r){e(t.exports,"StructFieldDefinition",()=>i);class i{TValue;TOmitInitKey;options;constructor(e){this.options=e}}}),a("4dyEt",function(t,r){e(t.exports,"StructFieldValue",()=>i);class i{definition;options;struct;get hasCustomAccessors(){return this.get!==i.prototype.get||this.set!==i.prototype.set}value;constructor(e,t,r,i){this.definition=e,this.options=t,this.struct=r,this.value=i}getSize(){return this.definition.getSize()}get(){return this.value}set(e){this.value=e}}}),a("8j8Qa",function(t,r){e(t.exports,"StructDefaultOptions",()=>i);let i={littleEndian:!1}}),a("70dme",function(t,r){e(t.exports,"ExactReadableEndedError",()=>i);class i extends Error{constructor(){super("ExactReadable ended"),Object.setPrototypeOf(this,new.target.prototype)}}}),a("iissA",function(t,r){e(t.exports,"STRUCT_VALUE_SYMBOL",()=>i),e(t.exports,"isStructValueInit",()=>n),e(t.exports,"StructValue",()=>a);let i=Symbol("struct-value");function n(e){return"object"==typeof e&&null!==e&&i in e}class a{fieldValues={};value;constructor(e){this.value=Object.create(e),Object.defineProperty(this.value,i,{enumerable:!1,value:this})}set(e,t){this.fieldValues[e]=t,t.hasCustomAccessors?Object.defineProperty(this.value,e,{configurable:!0,enumerable:!0,get:()=>t.get(),set(e){t.set(e)}}):this.value[e]=t.get()}get(e){return this.fieldValues[e]}}}),a("9LJSP",function(t,r){e(t.exports,"StructEmptyError",()=>b),e(t.exports,"Struct",()=>w),n("aF1FJ");var i=n("70dme"),a=n("iissA"),s=n("8j8Qa"),o=n("6yg6p");n("3rhZL");var l=n("ioobU"),c=n("7M0oO"),u=n("fiklF"),d=n("j4unN"),h=n("drcSV");class f extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class p extends f{constructor(){super("The underlying readable was ended before the struct was fully deserialized")}}class b extends f{constructor(){super("The underlying readable doesn't contain any more struct")}}class w{TFields;TOmitInitKey;TExtra;TInit;TDeserializeResult;options;#f=0;get size(){return this.#f}#p=[];get fields(){return this.#p}#b={};#w;constructor(e){this.options={...s.StructDefaultOptions,...e}}field(e,t){for(let t of this.#p)if(t[0]===e){let t=String(e);throw Error(`This struct already have a field with name '${t}'`)}this.#p.push([e,t]);let r=t.getSize();return this.#f+=r,this}concat(e){if(!(e instanceof w))throw TypeError("The other value must be a `Struct` instance");for(let t of e.#p)this.#p.push(t);return this.#f+=e.#f,Object.defineProperties(this.#b,Object.getOwnPropertyDescriptors(e.#b)),this}#g(e,t,r){return this.field(e,new u.NumberFieldDefinition(t,r))}int8(e,t){return this.#g(e,u.NumberFieldVariant.Int8,t)}uint8(e,t){return this.#g(e,u.NumberFieldVariant.Uint8,t)}int16(e,t){return this.#g(e,u.NumberFieldVariant.Int16,t)}uint16(e,t){return this.#g(e,u.NumberFieldVariant.Uint16,t)}int32(e,t){return this.#g(e,u.NumberFieldVariant.Int32,t)}uint32(e,t){return this.#g(e,u.NumberFieldVariant.Uint32,t)}#y(e,t,r){return this.field(e,new l.BigIntFieldDefinition(t,r))}int64(e,t){return this.#y(e,l.BigIntFieldVariant.Int64,t)}uint64(e,t){return this.#y(e,l.BigIntFieldVariant.Uint64,t)}#m=(e,t,r)=>"length"in r?this.field(e,new c.FixedLengthBufferLikeFieldDefinition(t,r)):this.field(e,new h.VariableLengthBufferLikeFieldDefinition(t,r));uint8Array=(e,t,r)=>this.#m(e,d.Uint8ArrayBufferFieldConverter.Instance,t,r);string=(e,t,r)=>this.#m(e,d.StringBufferFieldConverter.Instance,t,r);extra(e){return Object.defineProperties(this.#b,Object.getOwnPropertyDescriptors(e)),this}postDeserialize(e){return this.#w=e,this}deserialize(e){let t=new a.StructValue(this.#b),r=(0,o.SyncPromise).resolve(),n=e.position;for(let[a,s]of this.#p)r=r.then(()=>s.deserialize(this.options,e,t)).then(e=>{t.set(a,e)},t=>{if(!(t instanceof i.ExactReadableEndedError))throw t;if(e.position===n)throw new b;throw new p});return r.then(()=>{let e=t.value;if(this.#w){let t=this.#w.call(e,e);if(void 0!==t)return t}return e}).valueOrPromise()}serialize(e,t){let r;if((0,a.isStructValueInit)(e))for(let[t,i]of(r=e[a.STRUCT_VALUE_SYMBOL],Object.entries(e))){let e=r.get(t);e&&e.set(i)}else for(let[t,i]of(r=new a.StructValue({}),this.#p)){let n=i.create(this.options,r,e[t]);r.set(t,n)}let i=0,n=[];for(let[e]of this.#p){let t=r.get(e),a=t.getSize();n.push({fieldValue:t,size:a}),i+=a}if(t){if(t.length<i)throw TypeError("Output buffer is too small")}else t=new Uint8Array(i);let s=new DataView(t.buffer,t.byteOffset,t.byteLength),o=0;for(let{fieldValue:e,size:r}of n)e.serialize(s,t,o),o+=r;return t.length!==i?t.subarray(0,i):t}}}),a("6yg6p",function(t,r){e(t.exports,"SyncPromise",()=>i);let i={reject:e=>new s(e),resolve:e=>"object"!=typeof e||null===e||"function"!=typeof e.then?new a(e):e instanceof n||e instanceof a||e instanceof s?e:new n(e),try(e){try{return i.resolve(e())}catch(e){return i.reject(e)}}};class n{#S;constructor(e){this.#S=e}then(e,t){return new n(this.#S.then(e,t))}valueOrPromise(){return this.#S}}class a{#v;constructor(e){this.#v=e}then(e){return e?i.try(()=>e(this.#v)):this}valueOrPromise(){return this.#v}}class s{#x;constructor(e){this.#x=e}then(e,t){return t?i.try(()=>t(this.#x)):this}valueOrPromise(){throw this.#x}}}),a("3rhZL",function(t,r){e(t.exports,"BigIntFieldDefinition",()=>n("ioobU").BigIntFieldDefinition),e(t.exports,"BigIntFieldVariant",()=>n("ioobU").BigIntFieldVariant),e(t.exports,"EMPTY_UINT8_ARRAY",()=>n("j4unN").EMPTY_UINT8_ARRAY),e(t.exports,"FixedLengthBufferLikeFieldDefinition",()=>n("7M0oO").FixedLengthBufferLikeFieldDefinition),e(t.exports,"StringBufferFieldConverter",()=>n("j4unN").StringBufferFieldConverter),e(t.exports,"Uint8ArrayBufferFieldConverter",()=>n("j4unN").Uint8ArrayBufferFieldConverter),e(t.exports,"VariableLengthBufferLikeFieldDefinition",()=>n("drcSV").VariableLengthBufferLikeFieldDefinition),e(t.exports,"NumberFieldDefinition",()=>n("fiklF").NumberFieldDefinition),e(t.exports,"NumberFieldVariant",()=>n("fiklF").NumberFieldVariant),n("ioobU"),n("5R05c"),n("fiklF")}),a("ioobU",function(t,r){e(t.exports,"BigIntFieldVariant",()=>c),e(t.exports,"BigIntFieldDefinition",()=>u),n("cOond");var i=n("duafd"),a=n("jzfEx");n("aF1FJ");var s=n("hU3mS"),o=n("4dyEt"),l=n("6yg6p");class c{TTypeScriptType;size;deserialize;serialize;constructor(e,t,r){this.size=e,this.deserialize=t,this.serialize=r}static Int64=new c(8,i.getInt64,i.setInt64);static Uint64=new c(8,a.getUint64,a.setUint64)}class u extends s.StructFieldDefinition{variant;constructor(e,t){super(),this.variant=e}getSize(){return this.variant.size}create(e,t,r){return new d(this,e,t,r)}deserialize(e,t,r){return(0,l.SyncPromise).try(()=>t.readExactly(this.getSize())).then(t=>{let i=this.variant.deserialize(t,0,e.littleEndian);return this.create(e,r,i)}).valueOrPromise()}}class d extends o.StructFieldValue{serialize(e,t,r){this.definition.variant.serialize(t,r,this.value,this.options.littleEndian)}}}),a("cOond",function(t,r){e(t.exports,"getInt16",()=>n("eRgHk").getInt16),e(t.exports,"getInt32",()=>n("4smoc").getInt32),e(t.exports,"getInt64",()=>n("duafd").getInt64),e(t.exports,"setInt64",()=>n("duafd").setInt64),e(t.exports,"setInt64BigEndian",()=>n("duafd").setInt64BigEndian),e(t.exports,"setInt64LittleEndian",()=>n("duafd").setInt64LittleEndian),e(t.exports,"getInt8",()=>n("gBDJc").getInt8),e(t.exports,"getUint16",()=>n("hXg0k").getUint16),e(t.exports,"getUint32",()=>n("h4MAN").getUint32),e(t.exports,"getUint32LittleEndian",()=>n("h4MAN").getUint32LittleEndian),e(t.exports,"setUint32LittleEndian",()=>n("h4MAN").setUint32LittleEndian),e(t.exports,"getUint64",()=>n("jzfEx").getUint64),e(t.exports,"getUint64BigEndian",()=>n("jzfEx").getUint64BigEndian),e(t.exports,"getUint64LittleEndian",()=>n("jzfEx").getUint64LittleEndian),e(t.exports,"setUint64",()=>n("jzfEx").setUint64),n("eRgHk"),n("4smoc"),n("duafd"),n("gBDJc"),n("hXg0k"),n("h4MAN"),n("jzfEx")}),a("eRgHk",function(t,r){e(t.exports,"getInt16",()=>i);function i(e,t,r){return r?(e[t]|e[t+1]<<8)<<16>>16:(e[t]<<8|e[t+1])<<16>>16}}),a("4smoc",function(t,r){e(t.exports,"getInt32",()=>i);function i(e,t,r){return r?e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}}),a("duafd",function(t,r){function i(e,t,r){return r?BigInt(e[t])|BigInt(e[t+1])<<8n|BigInt(e[t+2])<<16n|BigInt(e[t+3])<<24n|BigInt(e[t+4])<<32n|BigInt(e[t+5])<<40n|BigInt(e[t+6])<<48n|BigInt(e[t+7]<<24)<<32n:BigInt(e[t]<<24)<<32n|BigInt(e[t+1])<<48n|BigInt(e[t+2])<<40n|BigInt(e[t+3])<<32n|BigInt(e[t+4])<<24n|BigInt(e[t+5])<<16n|BigInt(e[t+6])<<8n|BigInt(e[t+7])}function n(e,t,r){e[t]=Number(255n&r),e[t+1]=Number(r>>8n&255n),e[t+2]=Number(r>>16n&255n),e[t+3]=Number(r>>24n&255n),e[t+4]=Number(r>>32n&255n),e[t+5]=Number(r>>40n&255n),e[t+6]=Number(r>>48n&255n),e[t+7]=Number(r>>56n&255n)}function a(e,t,r){e[t]=Number(r>>56n&255n),e[t+1]=Number(r>>48n&255n),e[t+2]=Number(r>>40n&255n),e[t+3]=Number(r>>32n&255n),e[t+4]=Number(r>>24n&255n),e[t+5]=Number(r>>16n&255n),e[t+6]=Number(r>>8n&255n),e[t+7]=Number(255n&r)}function s(e,t,r,i){i?(e[t]=Number(255n&r),e[t+1]=Number(r>>8n&255n),e[t+2]=Number(r>>16n&255n),e[t+3]=Number(r>>24n&255n),e[t+4]=Number(r>>32n&255n),e[t+5]=Number(r>>40n&255n),e[t+6]=Number(r>>48n&255n),e[t+7]=Number(r>>56n&255n)):(e[t]=Number(r>>56n&255n),e[t+1]=Number(r>>48n&255n),e[t+2]=Number(r>>40n&255n),e[t+3]=Number(r>>32n&255n),e[t+4]=Number(r>>24n&255n),e[t+5]=Number(r>>16n&255n),e[t+6]=Number(r>>8n&255n),e[t+7]=Number(255n&r))}e(t.exports,"getInt64",()=>i),e(t.exports,"setInt64LittleEndian",()=>n),e(t.exports,"setInt64BigEndian",()=>a),e(t.exports,"setInt64",()=>s)}),a("gBDJc",function(t,r){e(t.exports,"getInt8",()=>i);function i(e,t){return e[t]<<24>>24}}),a("hXg0k",function(t,r){e(t.exports,"getUint16",()=>i);function i(e,t,r){return r?e[t]|e[t+1]<<8:e[t+1]|e[t]<<8}}),a("h4MAN",function(t,r){function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function n(e,t,r){return r?(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0:(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function a(e,t,r){e[t]=r,e[t+1]=r>>8,e[t+2]=r>>16,e[t+3]=r>>24}e(t.exports,"getUint32LittleEndian",()=>i),e(t.exports,"getUint32",()=>n),e(t.exports,"setUint32LittleEndian",()=>a)}),a("jzfEx",function(t,r){function i(e,t){return BigInt(e[t])|BigInt(e[t+1])<<8n|BigInt(e[t+2])<<16n|BigInt(e[t+3])<<24n|BigInt(e[t+4])<<32n|BigInt(e[t+5])<<40n|BigInt(e[t+6])<<48n|BigInt(e[t+7])<<56n}function n(e,t){return BigInt(e[t])<<56n|BigInt(e[t+1])<<48n|BigInt(e[t+2])<<40n|BigInt(e[t+3])<<32n|BigInt(e[t+4])<<24n|BigInt(e[t+5])<<16n|BigInt(e[t+6])<<8n|BigInt(e[t+7])}function a(e,t,r){return r?BigInt(e[t])|BigInt(e[t+1])<<8n|BigInt(e[t+2])<<16n|BigInt(e[t+3])<<24n|BigInt(e[t+4])<<32n|BigInt(e[t+5])<<40n|BigInt(e[t+6])<<48n|BigInt(e[t+7])<<56n:BigInt(e[t])<<56n|BigInt(e[t+1])<<48n|BigInt(e[t+2])<<40n|BigInt(e[t+3])<<32n|BigInt(e[t+4])<<24n|BigInt(e[t+5])<<16n|BigInt(e[t+6])<<8n|BigInt(e[t+7])}function s(e,t,r,i){i?(e[t]=Number(255n&r),e[t+1]=Number(r>>8n&255n),e[t+2]=Number(r>>16n&255n),e[t+3]=Number(r>>24n&255n),e[t+4]=Number(r>>32n&255n),e[t+5]=Number(r>>40n&255n),e[t+6]=Number(r>>48n&255n),e[t+7]=Number(r>>56n&255n)):(e[t]=Number(r>>56n&255n),e[t+1]=Number(r>>48n&255n),e[t+2]=Number(r>>40n&255n),e[t+3]=Number(r>>32n&255n),e[t+4]=Number(r>>24n&255n),e[t+5]=Number(r>>16n&255n),e[t+6]=Number(r>>8n&255n),e[t+7]=Number(255n&r))}e(t.exports,"getUint64LittleEndian",()=>i),e(t.exports,"getUint64BigEndian",()=>n),e(t.exports,"getUint64",()=>a),e(t.exports,"setUint64",()=>s)}),a("5R05c",function(t,r){e(t.exports,"EMPTY_UINT8_ARRAY",()=>n("j4unN").EMPTY_UINT8_ARRAY),e(t.exports,"StringBufferFieldConverter",()=>n("j4unN").StringBufferFieldConverter),e(t.exports,"Uint8ArrayBufferFieldConverter",()=>n("j4unN").Uint8ArrayBufferFieldConverter),e(t.exports,"FixedLengthBufferLikeFieldDefinition",()=>n("7M0oO").FixedLengthBufferLikeFieldDefinition),e(t.exports,"VariableLengthBufferLikeFieldDefinition",()=>n("drcSV").VariableLengthBufferLikeFieldDefinition),n("j4unN"),n("7M0oO"),n("drcSV")}),a("j4unN",function(t,r){e(t.exports,"Uint8ArrayBufferFieldConverter",()=>c),e(t.exports,"StringBufferFieldConverter",()=>u),e(t.exports,"EMPTY_UINT8_ARRAY",()=>d),e(t.exports,"BufferLikeFieldDefinition",()=>h),e(t.exports,"BufferLikeFieldValue",()=>f),n("aF1FJ");var i=n("hU3mS"),a=n("4dyEt"),s=n("6yg6p"),o=n("6Savq");class l{TTypeScriptType}class c extends l{static Instance=new c;constructor(){super()}toBuffer(e){return e}toValue(e){return e}getSize(e){return e.length}}class u extends l{static Instance=new u;toBuffer(e){return(0,o.encodeUtf8)(e)}toValue(e){return(0,o.decodeUtf8)(e)}getSize(){}}let d=new Uint8Array(0);class h extends i.StructFieldDefinition{converter;TTypeScriptType;constructor(e,t){super(t),this.converter=e}getDeserializeSize(e){return this.getSize()}create(e,t,r,i){return new f(this,e,t,r,i)}deserialize(e,t,r){return(0,s.SyncPromise).try(()=>{let e=this.getDeserializeSize(r);return 0===e?d:t.readExactly(e)}).then(t=>{let i=this.converter.toValue(t);return this.create(e,r,i,t)}).valueOrPromise()}}class f extends a.StructFieldValue{array;constructor(e,t,r,i,n){super(e,t,r,i),this.array=n}set(e){super.set(e),this.array=void 0}serialize(e,t,r){this.array??=this.definition.converter.toBuffer(this.value),t.set(this.array,r)}}}),a("6Savq",function(t,r){function i(){}e(t.exports,"placeholder",()=>i),e(t.exports,"encodeUtf8",()=>l),e(t.exports,"decodeUtf8",()=>c);let{TextEncoder:n,TextDecoder:a}=globalThis,s=new n,o=new a;function l(e){return s.encode(e)}function c(e){return o.decode(e)}}),a("7M0oO",function(t,r){e(t.exports,"FixedLengthBufferLikeFieldDefinition",()=>a);var i=n("j4unN");class a extends i.BufferLikeFieldDefinition{getSize(){return this.options.length}}}),a("drcSV",function(t,r){e(t.exports,"VariableLengthBufferLikeFieldDefinition",()=>s),n("aF1FJ");var i=n("4dyEt"),a=n("j4unN");class s extends a.BufferLikeFieldDefinition{getSize(){return 0}getDeserializeSize(e){let t=e.value[this.options.lengthField];return"string"==typeof t&&(t=Number.parseInt(t,this.options.lengthFieldRadix??10)),t}create(e,t,r,i){return new o(this,e,t,r,i)}}class o extends a.BufferLikeFieldValue{length;lengthFieldValue;constructor(e,t,r,i,n){super(e,t,r,i,n),n&&(this.length=n.length);let a=this.definition.options.lengthField,s=r.get(a);this.lengthFieldValue=new l(s,this),r.set(a,this.lengthFieldValue)}#E(){let e=this.definition.converter.getSize(this.value);if(void 0!==e&&e<0)throw Error("Invalid length");return e}getSize(){return void 0===this.length&&(this.length=this.#E()),void 0===this.length&&(this.array=this.definition.converter.toBuffer(this.value),this.length=this.array.length),this.length}set(e){super.set(e),this.array=void 0,this.length=void 0}}class l extends i.StructFieldValue{originalValue;bufferValue;constructor(e,t){super(e.definition,e.options,e.struct,0),this.originalValue=e,this.bufferValue=t}getSize(){return this.originalValue.getSize()}get(){let e=this.bufferValue.getSize();return"string"==typeof this.originalValue.get()&&(e=e.toString(this.bufferValue.definition.options.lengthFieldRadix??10)),e}set(){}serialize(e,t,r){this.originalValue.set(this.get()),this.originalValue.serialize(e,t,r)}}}),a("fiklF",function(t,r){e(t.exports,"NumberFieldVariant",()=>a),e(t.exports,"NumberFieldDefinition",()=>p),n("cOond");var i,a,s=n("eRgHk"),o=n("4smoc"),l=n("gBDJc"),c=n("hXg0k"),u=n("h4MAN");n("aF1FJ");var d=n("hU3mS"),h=n("4dyEt"),f=n("6yg6p");(i=a||(a={})).Uint8={signed:!1,size:1,deserialize:e=>e[0],serialize(e,t,r){e.setUint8(t,r)}},i.Int8={signed:!0,size:1,deserialize:e=>(0,l.getInt8)(e,0),serialize(e,t,r){e.setInt8(t,r)}},i.Uint16={signed:!1,size:2,deserialize:(e,t)=>(0,c.getUint16)(e,0,t),serialize(e,t,r,i){e.setUint16(t,r,i)}},i.Int16={signed:!0,size:2,deserialize:(e,t)=>(0,s.getInt16)(e,0,t),serialize(e,t,r,i){e.setInt16(t,r,i)}},i.Uint32={signed:!1,size:4,deserialize:(e,t)=>(0,u.getUint32)(e,0,t),serialize(e,t,r,i){e.setUint32(t,r,i)}},i.Int32={signed:!0,size:4,deserialize:(e,t)=>(0,o.getInt32)(e,0,t),serialize(e,t,r,i){e.setInt32(t,r,i)}};class p extends d.StructFieldDefinition{variant;constructor(e,t){super(),this.variant=e}getSize(){return this.variant.size}create(e,t,r){return new b(this,e,t,r)}deserialize(e,t,r){return(0,f.SyncPromise).try(()=>t.readExactly(this.getSize())).then(t=>{let i=this.variant.deserialize(t,e.littleEndian);return this.create(e,r,i)}).valueOrPromise()}}class b extends h.StructFieldValue{serialize(e,t,r){this.definition.variant.serialize(e,r,this.value,this.options.littleEndian)}}}),a("bJSM1",function(t,r){e(t.exports,"BufferedReadableStream",()=>o),n("hr1EK");var i=n("70dme"),a=n("fnPEF");let s=()=>{};class o{#A;#k=0;#I=0;#t=0;get position(){return this.#t}stream;reader;constructor(e){this.stream=e,this.reader=e.getReader()}async #R(){let{done:e,value:t}=await this.reader.read();if(e)throw new i.ExactReadableEndedError;return t}async #C(e,t){let r,i;if(t)(r=new Uint8Array(e)).set(t),i=t.length,e-=t.length;else{let t=await this.#R();if(t.length===e)return this.#t+=e,t;if(t.length>e)return this.#A=t,this.#k=e,this.#I=t.length-e,this.#t+=e,t.subarray(0,e);(r=new Uint8Array(e)).set(t),i=t.length,e-=t.length,this.#t+=t.length}for(;e>0;){let t=await this.#R();if(t.length===e){r.set(t,i),this.#t+=e;break}if(t.length>e){this.#A=t,this.#k=e,this.#I=t.length-e,r.set(t.subarray(0,e),i),this.#t+=e;break}r.set(t,i),i+=t.length,e-=t.length,this.#t+=t.length}return r}readExactly(e){if(this.#A){let t=this.#A,r=this.#k;return this.#I>e?(this.#k+=e,this.#I-=e,this.#t+=e,t.subarray(r,r+e)):(this.#A=void 0,this.#I=0,this.#k=0,this.#t+=t.length-r,this.#C(e,t.subarray(r)))}return this.#C(e)}release(){return this.#I>0?new a.PushReadableStream(async e=>{let t=this.#A.subarray(this.#k);for(await e.enqueue(t),e.abortSignal.addEventListener("abort",()=>{this.reader.cancel().catch(s)});;){let{done:t,value:r}=await this.reader.read();if(t)return;await e.enqueue(r)}}):(this.reader.releaseLock(),this.stream)}async cancel(e){await this.reader.cancel(e)}}}),a("fnPEF",function(t,r){e(t.exports,"PushReadableStream",()=>s),n("kV55x");var i=n("aHKds"),a=n("6NYMu");class s extends a.ReadableStream{#T=!1;constructor(e,t){let r;let n=new a.AbortController;super({start:async t=>{await Promise.resolve();let a=e({abortSignal:n.signal,enqueue:async e=>{if(n.signal.aborted)throw n.signal.reason;if(null===t.desiredSize){t.enqueue(e);return}if(this.#T){this.#T=!1,t.enqueue(e);return}t.desiredSize<=0&&(r=new i.PromiseResolver,await r.promise),t.enqueue(e)},close(){t.close()},error(e){t.error(e)}});a&&"then"in a&&a.then(()=>{try{t.close()}catch(e){}},e=>{t.error(e)})},pull:()=>{if(r){r.resolve();return}t?.highWaterMark===0&&(this.#T=!0)},cancel:e=>{n.abort(e),r?.reject(e)}},t)}}}),a("kV55x",function(t,r){e(t.exports,"AsyncOperationManager",()=>n("1PmPk").AsyncOperationManager),e(t.exports,"delay",()=>n("5OCzC").delay),e(t.exports,"PromiseResolver",()=>n("aHKds").PromiseResolver),n("1PmPk"),n("5OCzC"),n("aHKds")}),a("1PmPk",function(t,r){e(t.exports,"AsyncOperationManager",()=>a);var i=n("aHKds"),a=function(){function e(e){void 0===e&&(e=0),this.pendingResolvers=new Map,this.nextId=e}return e.prototype.add=function(){var e=this.nextId++,t=new i.PromiseResolver;return this.pendingResolvers.set(e,t),[e,t.promise]},e.prototype.getResolver=function(e){if(!this.pendingResolvers.has(e))return null;var t=this.pendingResolvers.get(e);return this.pendingResolvers.delete(e),t},e.prototype.resolve=function(e,t){var r=this.getResolver(e);return null!==r&&(r.resolve(t),!0)},e.prototype.reject=function(e,t){var r=this.getResolver(e);return null!==r&&(r.reject(t),!0)},e}()}),a("aHKds",function(t,r){e(t.exports,"PromiseResolver",()=>i);var i=function(){function e(){var e=this;this._state="running",this.resolve=function(t){e._resolve(t),e._state="resolved"},this.reject=function(t){e._reject(t),e._state="rejected"},this._promise=new Promise(function(t,r){e._resolve=t,e._reject=r})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e}()}),a("5OCzC",function(t,r){e(t.exports,"delay",()=>i);function i(e){return new Promise(function(t){globalThis.setTimeout(function(){return t()},e)})}}),a("6NYMu",function(t,r){e(t.exports,"AbortController",()=>a),e(t.exports,"ReadableStream",()=>s),e(t.exports,"WritableStream",()=>o),e(t.exports,"TransformStream",()=>l),n("lAXwl");let i=globalThis,a=i.AbortController,s=i.ReadableStream,o=i.WritableStream,l=i.TransformStream}),a("lAXwl",function(e,t){}),a("k61Wg",function(t,r){e(t.exports,"ConcatStringStream",()=>s),n("kV55x");var i=n("aHKds");n("hr1EK"),n("j4unN");var a=n("6NYMu");class s{#P="";#N=new i.PromiseResolver;#s=new a.WritableStream({write:e=>{this.#P+=e},close:()=>{this.#N.resolve(this.#P),this.#F.enqueue(this.#P),this.#F.close()},abort:e=>{this.#N.reject(e),this.#F.error(e)}});get writable(){return this.#s}#F;#a=new a.ReadableStream({start:e=>{this.#F=e}});get readable(){return this.#a}constructor(){Object.defineProperties(this.#a,{then:{get:()=>this.#N.promise.then.bind(this.#N.promise)},catch:{get:()=>this.#N.promise.catch.bind(this.#N.promise)},finally:{get:()=>this.#N.promise.finally.bind(this.#N.promise)}})}}}),a("5Ywqs",function(t,r){e(t.exports,"Consumable",()=>o),n("kV55x");var i=n("aHKds"),a=n("6NYMu"),s=n("cilb9");class o{#D;#N;value;consumed;constructor(e){this.#D=(0,s.createTask)("Consumable"),this.value=e,this.#N=new i.PromiseResolver,this.consumed=this.#N.promise}consume(){this.#N.resolve()}error(e){this.#N.reject(e)}tryConsume(e){try{var t;let r=this.#D.run(()=>e(this.value));return(t=r,"object"==typeof t&&null!==t&&"then"in t)?r=r.then(e=>(this.#N.resolve(),e),e=>{throw this.#N.reject(e),e}):this.#N.resolve(),r}catch(e){throw this.#N.reject(e),e}}}!function(e){class t extends a.WritableStream{static async write(t,r){let i=new e(r);await t.write(i),await i.consumed}constructor(t,r){let i;r&&(i={},"highWaterMark"in r&&(i.highWaterMark=r.highWaterMark),"size"in r&&(i.size=t=>r.size(t instanceof e?t.value:t))),super({start:e=>t.start?.(e),async write(e,r){await e.tryConsume(e=>t.write?.(e,r))},abort:e=>t.abort?.(e),close:()=>t.close?.()},i)}}e.WritableStream=t;class r extends a.ReadableStream{static async enqueue(t,r){let i=new e(r);t.enqueue(i),await i.consumed}constructor(e,t){let i,n;t&&(n={},"highWaterMark"in t&&(n.highWaterMark=t.highWaterMark),"size"in t&&(n.size=e=>t.size(e.value))),super({async start(t){i={async enqueue(e){await r.enqueue(t,e)},close(){t.close()},error(e){t.error(e)}},await e.start?.(i)},async pull(){await e.pull?.(i)},async cancel(t){await e.cancel?.(t)}},n)}}e.ReadableStream=r}(o||(o={}))}),a("cilb9",function(t,r){e(t.exports,"createTask",()=>n);let{console:i}=globalThis,n=i?.createTask?.bind(i)??(()=>({run:e=>e()}))}),a("b5TnZ",function(t,r){e(t.exports,"BufferCombiner",()=>o),e(t.exports,"DistributionStream",()=>l);var i=n("5Ywqs"),a=n("jEctC"),s=n("6NYMu");class o{#B;#L;#z;#U;constructor(e){this.#B=e,this.#L=new Uint8Array(e),this.#z=0,this.#U=e}*push(e){let t=0,r=e.length;if(0!==this.#z){if(r>=this.#U){if(this.#L.set(e.subarray(0,this.#U),this.#z),t+=this.#U,r-=this.#U,yield this.#L,this.#z=0,this.#U=this.#B,0===r)return}else{this.#L.set(e,this.#z),this.#z+=r,this.#U-=r;return}}for(;r>=this.#B;){let i=t+this.#B;yield e.subarray(t,i),t=i,r-=this.#B}r>0&&(this.#L.set(e.subarray(t),this.#z),this.#z+=r,this.#U-=r)}flush(){if(0===this.#z)return;let e=this.#L.subarray(0,this.#z);return this.#z=0,this.#U=this.#B,e}}class l extends s.TransformStream{constructor(e,t=!1){let r=t?new o(e):void 0;super({async transform(t,n){await (0,a.MaybeConsumable).tryConsume(t,async t=>{if(r)for(let e of r.push(t))await (0,i.Consumable).ReadableStream.enqueue(n,e);else{let r=0,a=t.length;for(;a>0;){let s=r+e;await (0,i.Consumable).ReadableStream.enqueue(n,t.subarray(r,s)),r=s,a-=e}}})},flush(e){if(r){let t=r.flush();t&&e.enqueue(t)}}})}}}),a("jEctC",function(t,r){e(t.exports,"MaybeConsumable",()=>i);var i,a=n("5Ywqs"),s=n("6NYMu");!function(e){e.getValue=function(e){return e instanceof a.Consumable?e.value:e},e.tryConsume=function(e,t){return e instanceof a.Consumable?e.tryConsume(t):t(e)};class t extends s.TransformStream{constructor(){super({transform(t,r){e.tryConsume(t,e=>{r.enqueue(e)})}})}}e.UnwrapStream=t;class r extends s.WritableStream{constructor(t,r){let i;r&&(i={},"highWaterMark"in r&&(i.highWaterMark=r.highWaterMark),"size"in r&&(i.size=e=>r.size(e instanceof a.Consumable?e.value:e))),super({start:e=>t.start?.(e),async write(r,i){await e.tryConsume(r,e=>t.write?.(e,i))},abort:e=>t.abort?.(e),close:()=>t.close?.()},i)}}e.WritableStream=r}(i||(i={}))}),a("bwQFm",function(t,r){e(t.exports,"DuplexStreamFactory",()=>l),n("kV55x");var i=n("aHKds"),a=n("6NYMu"),s=n("cSu3L");let o=()=>{};class l{#O=[];#_=[];#V=!1;get writableClosed(){return this.#V}#M=new i.PromiseResolver;get closed(){return this.#M.promise}#W;constructor(e){this.#W=e??{}}wrapReadable(e,t){return new s.WrapReadableStream({start:t=>(this.#O.push(t),e),cancel:async()=>{await this.close()},close:async()=>{await this.dispose()}},t)}createWritable(e){let t=e.getWriter();return this.#_.push(t),new a.WritableStream({write:async e=>{await t.write(e)},abort:async e=>{await t.abort(e),await this.close()},close:async()=>{await t.close().catch(o),await this.close()}})}async close(){if(!this.#V)for(let e of(this.#V=!0,await this.#W.close?.()!==!1&&await this.dispose(),this.#_))e.close().catch(o)}async dispose(){for(let e of(this.#V=!0,this.#M.resolve(),this.#O))try{e.close()}catch{}await this.#W.dispose?.()}}}),a("cSu3L",function(t,r){e(t.exports,"WrapReadableStream",()=>a);var i=n("6NYMu");class a extends i.ReadableStream{readable;#q;constructor(e,t){super({start:async t=>{await Promise.resolve(),this.readable=await ("start"in e?e.start(t):"function"==typeof e?e(t):e),this.#q=this.readable.getReader()},pull:async t=>{let r=await this.#q.read();r.done?(t.close(),"close"in e&&await e.close?.()):t.enqueue(r.value)},cancel:async t=>{await this.#q.cancel(t),"cancel"in e&&await e.cancel?.(t)}},t)}}}),a("koQVx",function(t,r){e(t.exports,"TextDecoderStream",()=>n);let i=globalThis,n=i.TextDecoderStream;i.TextEncoderStream}),a("4eHDJ",function(e,t){n("6NYMu")}),a("3Ppgt",function(t,r){e(t.exports,"pipeFrom",()=>a);var i=n("6NYMu");function a(e,t){let r=t.writable.getWriter(),n=t.readable.pipeTo(e);return new i.WritableStream({async write(e){await r.write(e)},async close(){await r.close(),await n}})}}),a("jbstH",function(e,t){n("6NYMu")}),a("ebpYL",function(t,r){e(t.exports,"StructDeserializeStream",()=>a);var i=n("1QeNb");class a extends i.BufferedTransformStream{constructor(e){super(t=>e.deserialize(t))}}}),a("1yRYZ",function(e,t){n("6NYMu")}),a("67qk3",function(t,r){e(t.exports,"WrapWritableStream",()=>s);var i=n("6NYMu");async function a(e){return"start"in e?await e.start():"function"==typeof e?await e():e}class s extends i.WritableStream{writable;#j;constructor(e){super({start:async()=>{await Promise.resolve(),this.writable=await a(e),this.#j=this.writable.getWriter()},write:async e=>{await this.#j.write(e)},abort:async t=>{await this.#j.abort(t),e!==this.writable&&"close"in e&&await e.close?.()},close:async()=>{await this.#j.close(),e!==this.writable&&"close"in e&&await e.close?.()}})}bePipedThroughFrom(e){let t;return new s({start:()=>(t=e.readable.pipeTo(this),e.writable),async close(){await t}})}}}),a("chJ24",function(t,r){e(t.exports,"framebuffer",()=>n("755W6").framebuffer),e(t.exports,"AdbPower",()=>n("5WSZn").AdbPower),e(t.exports,"AdbReverseCommand",()=>n("gequt").AdbReverseCommand),e(t.exports,"AdbSubprocess",()=>n("5jHg5").AdbSubprocess),e(t.exports,"AdbSubprocessShellProtocol",()=>n("23OH0").AdbSubprocessShellProtocol),e(t.exports,"escapeArg",()=>n("beA73").escapeArg),e(t.exports,"AdbSync",()=>n("aBc50").AdbSync),e(t.exports,"AdbTcpIpCommand",()=>n("liel6").AdbTcpIpCommand),n("2TOFC"),n("755W6"),n("5WSZn"),n("gequt"),n("ezTiR"),n("3HODG"),n("liel6")}),a("2TOFC",function(t,r){e(t.exports,"AdbCommandBase",()=>a),n("hpom2");var i=n("aGQPd");class a extends i.AutoDisposable{adb;constructor(e){super(),this.adb=e}}}),a("hpom2",function(t,r){e(t.exports,"AutoDisposable",()=>n("aGQPd").AutoDisposable),n("aGQPd"),n("67ny9"),n("lreyP"),n("5oa12")}),a("aGQPd",function(t,r){e(t.exports,"AutoDisposable",()=>i);class i{#Y=[];constructor(){this.dispose=this.dispose.bind(this)}addDisposable(e){return this.#Y.push(e),e}dispose(){for(let e of this.#Y)e.dispose();this.#Y=[]}}}),a("67ny9",function(e,t){}),a("lreyP",function(e,t){}),a("5oa12",function(e,t){n("kV55x"),n("aHKds")}),a("755W6",function(t,r){e(t.exports,"framebuffer",()=>h),n("7edQJ");var i=n("bJSM1");n("hr1EK");var a=n("9LJSP");let s=new(0,a.Struct)({littleEndian:!0}).uint32("version"),o=new(0,a.Struct)({littleEndian:!0}).uint32("bpp").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").uint8Array("data",{lengthField:"size"}),l=new(0,a.Struct)({littleEndian:!0}).uint32("bpp").uint32("colorSpace").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").uint8Array("data",{lengthField:"size"});class c extends Error{constructor(e,t){super(e,t)}}class u extends c{constructor(e){super(`Unsupported FrameBuffer version ${e}`)}}class d extends c{constructor(){super("FrameBuffer is disabled by current app")}}async function h(e){let t;let r=await e.createSocket("framebuffer:"),n=new i.BufferedReadableStream(r.readable);try{({version:t}=await s.deserialize(n))}catch(e){if(e instanceof a.StructEmptyError)throw new d;throw e}switch(t){case 1:return o.deserialize(n);case 2:return l.deserialize(n);default:throw new u(t)}}}),a("5WSZn",function(t,r){e(t.exports,"AdbPower",()=>a);var i=n("2TOFC");class a extends i.AdbCommandBase{reboot(e=""){return this.adb.createSocketAndWait(`reboot:${e}`)}bootloader(){return this.reboot("bootloader")}fastboot(){return this.reboot("fastboot")}recovery(){return this.reboot("recovery")}sideload(){return this.reboot("sideload")}qualcommEdlMode(){return this.reboot("edl")}powerOff(){return this.adb.subprocess.spawnAndWaitLegacy(["reboot","-p"])}powerButton(e=!1){let t=["input","keyevent"];return e&&t.push("--longpress"),t.push("POWER"),this.adb.subprocess.spawnAndWaitLegacy(t)}samsungOdin(){return this.reboot("download")}}}),a("gequt",function(t,r){e(t.exports,"AdbReverseCommand",()=>w),n("hpom2");var i=n("aGQPd");n("7edQJ");var a=n("bJSM1");n("hr1EK");var s=n("9LJSP"),o=n("6Savq"),l=n("70dme");n("5lBQi");var c=n("32bmk"),u=n("gtlgZ");let d=new(0,s.Struct)().string("length",{length:4}).string("content",{lengthField:"length",lengthFieldRadix:16});class h extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class f extends h{constructor(){super("ADB reverse tunnel is not supported on this device when connected wirelessly.")}}let p=new(0,s.Struct)().concat(d).postDeserialize(e=>{if("more than one device/emulator"===e.content)throw new f;throw new h(e.content)}),b=(0,o.encodeUtf8)("OKAY");class w extends i.AutoDisposable{adb;#H=new Map;constructor(e){super(),this.adb=e}async createBufferedStream(e){let t=await this.adb.createSocket(e);return new a.BufferedReadableStream(t.readable)}async sendRequest(e){let t=await this.createBufferedStream(e),r=await t.readExactly(4);return(0,u.sequenceEqual)(r,b)||await p.deserialize(t),t}async list(){let e=await this.createBufferedStream("reverse:list-forward");return(await d.deserialize(e)).content.split("\n").filter(e=>!!e).map(e=>{let[t,r,i]=e.split(" ");return{deviceSerial:t,localName:r,remoteName:i}})}async addExternal(e,t){let r=await this.sendRequest(`reverse:forward:${e};${t}`);if(e.startsWith("tcp:")){let t=r.position;try{let t=(0,c.hexToNumber)(await r.readExactly(4)),i=function(e){let t=0;for(let r of e){if(r<48||r>57)break;t=10*t+r-48}return t}(await r.readExactly(t));e=`tcp:${i}`}catch(e){if(e instanceof l.ExactReadableEndedError&&r.position===t);else throw e}}return e}async add(e,t,r){r=await this.adb.transport.addReverseTunnel(t,r);try{return e=await this.addExternal(e,r),this.#H.set(e,r),e}catch(e){throw await this.adb.transport.removeReverseTunnel(r),e}}async remove(e){let t=this.#H.get(e);t&&await this.adb.transport.removeReverseTunnel(t),await this.sendRequest(`reverse:killforward:${e}`)}async removeAll(){await this.adb.transport.clearReverseTunnels(),this.#H.clear(),await this.sendRequest("reverse:killforward-all")}}}),a("5lBQi",function(t,r){e(t.exports,"AutoResetEvent",()=>n("5SRHv").AutoResetEvent),e(t.exports,"calculateBase64EncodedLength",()=>n("2kccq").calculateBase64EncodedLength),e(t.exports,"encodeBase64",()=>n("2kccq").encodeBase64),e(t.exports,"hexToNumber",()=>n("32bmk").hexToNumber),e(t.exports,"write4HexDigits",()=>n("32bmk").write4HexDigits),e(t.exports,"NOOP",()=>n("fXuIk").NOOP),e(t.exports,"unreachable",()=>n("fXuIk").unreachable),e(t.exports,"sequenceEqual",()=>n("gtlgZ").sequenceEqual),e(t.exports,"encodeUtf8",()=>n("6Savq").encodeUtf8),n("hr1EK"),n("6Savq"),n("5SRHv"),n("2kccq"),n("32bmk"),n("fXuIk"),n("gtlgZ")}),a("5SRHv",function(t,r){e(t.exports,"AutoResetEvent",()=>a),n("kV55x");var i=n("aHKds");class a{#J;#K=[];constructor(e=!1){this.#J=e}wait(){if(!this.#J&&(this.#J=!0,0===this.#K.length))return Promise.resolve();let e=new i.PromiseResolver;return this.#K.push(e),e.promise}notifyOne(){0!==this.#K.length?this.#K.pop().resolve():this.#J=!1}dispose(){for(let e of this.#K)e.reject(Error("The AutoResetEvent has been disposed"));this.#K.length=0}}}),a("2kccq",function(t,r){e(t.exports,"calculateBase64EncodedLength",()=>s),e(t.exports,"encodeBase64",()=>o);let i=[],n=[];function a(e,t){let r=e.charCodeAt(0),a=t.charCodeAt(0);for(let e=r;e<=a;e+=1)i[e]=n.length,n.push(e)}function s(e){let t=e%3,r=0!==t?3-t:0;return[(e+r)/3*4,r]}function o(e,t){let[r,i]=s(e.length);if(!t)return l(e,t=new Uint8Array(r),i),t;if(t.length<r)throw TypeError("output buffer is too small");if(t=t.subarray(0,r),e.buffer!==t.buffer)l(e,t,i);else if(t.byteOffset+t.length-(i+1)<=e.byteOffset+e.length)l(e,t,i);else if(t.byteOffset>=e.byteOffset-1)(function(e,t,r){let i=e.length-1,a=t.length-1;if(2===r){let r=e[i];i-=1,t[a]=61,t[a-=1]=61,t[a-=1]=n[(3&r)<<4],t[a-=1]=n[r>>2],a-=1}else if(1===r){let r=e[i],s=e[i-=1];i-=1,t[a]=61,t[a-=1]=n[(15&r)<<2],t[a-=1]=n[(3&s)<<4|r>>4],t[a-=1]=n[s>>2],a-=1}for(;i>=0;){let r=e[i],s=e[i-=1],o=e[i-=1];i-=1,t[a]=n[63&r],t[a-=1]=n[(15&s)<<2|r>>6],t[a-=1]=n[(3&o)<<4|s>>4],t[a-=1]=n[o>>2],a-=1}})(e,t,i);else throw TypeError("input and output cannot overlap");return r}function l(e,t,r){let i=0,a=0;for(;i<e.length-2;){let r=e[i],s=e[i+=1],o=e[i+=1];i+=1,t[a]=n[r>>2],t[a+=1]=n[(3&r)<<4|s>>4],t[a+=1]=n[(15&s)<<2|o>>6],t[a+=1]=n[63&o],a+=1}if(2===r){let r=e[i];i+=1,t[a]=n[r>>2],t[a+=1]=n[(3&r)<<4],t[a+=1]=61,t[a+=1]=61}else if(1===r){let r=e[i],s=e[i+=1];i+=1,t[a]=n[r>>2],t[a+=1]=n[(3&r)<<4|s>>4],t[a+=1]=n[(15&s)<<2],t[a+=1]=61}}a("A","Z"),a("a","z"),a("0","9"),a("+","+"),a("/","/")}),a("32bmk",function(t,r){function i(e){let t=0;for(let r=0;r<e.length;r+=1)t=t<<4|function(e){if(e<48)throw TypeError(`Invalid hex char ${e}`);if(e<58)return e-48;if(e<65)throw TypeError(`Invalid hex char ${e}`);if(e<71)return e-55;if(e<97)throw TypeError(`Invalid hex char ${e}`);if(e<103)return e-87;throw TypeError(`Invalid hex char ${e}`)}(e[r]);return t}function n(e,t,r){let i=t;for(t+=3;t>=i&&r>0;){let i=15&r;r>>=4,i<10?e[t]=i+48:e[t]=i+87,t-=1}for(;t>=i;)e[t]=48,t-=1}e(t.exports,"hexToNumber",()=>i),e(t.exports,"write4HexDigits",()=>n)}),a("fXuIk",function(t,r){e(t.exports,"NOOP",()=>i),e(t.exports,"unreachable",()=>n);let i=()=>{};function n(...e){throw Error("Unreachable. Arguments:\n"+e.join("\n"))}}),a("gtlgZ",function(t,r){e(t.exports,"sequenceEqual",()=>i);function i(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1)if(e[r]!==t[r])return!1;return!0}}),a("ezTiR",function(t,r){e(t.exports,"AdbSubprocess",()=>n("5jHg5").AdbSubprocess),e(t.exports,"AdbSubprocessShellProtocol",()=>n("23OH0").AdbSubprocessShellProtocol),e(t.exports,"escapeArg",()=>n("beA73").escapeArg),n("5jHg5"),n("cv2l6"),n("beA73")}),a("5jHg5",function(t,r){e(t.exports,"AdbSubprocess",()=>c),n("7edQJ");var i=n("k61Wg"),a=n("koQVx"),s=n("2TOFC");n("cv2l6");var o=n("co9iz");let l={protocols:[n("23OH0").AdbSubprocessShellProtocol,o.AdbSubprocessNoneProtocol]};class c extends s.AdbCommandBase{async #$(e,t,r){let i;let{protocols:n}={...l,...r};for(let e of n)if(await e.isSupported(this.adb)){i=e;break}if(!i)throw Error("No specified protocol is supported by the device");return Array.isArray(t)?t=t.join(" "):void 0===t&&(t=""),await i[e](this.adb,t)}shell(e,t){return this.#$("pty",e,t)}spawn(e,t){return this.#$("raw",e,t)}async spawnAndWait(e,t){let r=await this.spawn(e,t),[n,s,o]=await Promise.all([r.stdout.pipeThrough(new a.TextDecoderStream).pipeThrough(new i.ConcatStringStream),r.stderr.pipeThrough(new a.TextDecoderStream).pipeThrough(new i.ConcatStringStream),r.exit]);return{stdout:n,stderr:s,exitCode:o}}async spawnAndWaitLegacy(e){let{stdout:t}=await this.spawnAndWait(e,{protocols:[o.AdbSubprocessNoneProtocol]});return t}}}),a("cv2l6",function(t,r){e(t.exports,"AdbSubprocessNoneProtocol",()=>n("co9iz").AdbSubprocessNoneProtocol),e(t.exports,"AdbSubprocessShellProtocol",()=>n("23OH0").AdbSubprocessShellProtocol),n("co9iz"),n("23OH0"),n("cUsti")}),a("co9iz",function(t,r){e(t.exports,"AdbSubprocessNoneProtocol",()=>s),n("7edQJ");var i=n("6NYMu");n("5lBQi");var a=n("fXuIk");class s{static isSupported(){return!0}static async pty(e,t){return new s(await e.createSocket(`shell:${t}`))}static async raw(e,t){return new s(await e.createSocket(`exec:${t}`))}#Q;get stdin(){return this.#Q.writable}get stdout(){return this.#Q.readable}#G;get stderr(){return this.#G}#Z;get exit(){return this.#Z}constructor(e){this.#Q=e,this.#G=new i.ReadableStream({start:e=>{this.#Q.closed.then(()=>e.close()).catch(a.unreachable)}}),this.#Z=e.closed.then(()=>0)}resize(){}async kill(){await this.#Q.close()}}}),a("23OH0",function(t,r){e(t.exports,"AdbSubprocessShellProtocol",()=>b),n("kV55x");var i,a,s=n("aHKds");n("7edQJ");var o=n("jEctC"),l=n("fnPEF"),c=n("ebpYL"),u=n("6NYMu");n("hr1EK");var d=n("9LJSP"),h=n("6Savq"),f=n("drR7i");n("5lBQi");var h=n("6Savq");(i=a||(a={}))[i.Stdin=0]="Stdin",i[i.Stdout=1]="Stdout",i[i.Stderr=2]="Stderr",i[i.Exit=3]="Exit",i[i.CloseStdin=4]="CloseStdin",i[i.WindowSizeChange=5]="WindowSizeChange";let p=new(0,d.Struct)({littleEndian:!0}).uint8("id",(0,h.placeholder)()).uint32("length").uint8Array("data",{lengthField:"length"});class b{static isSupported(e){return e.canUseFeature(f.AdbFeature.ShellV2)}static async pty(e,t){return new b(await e.createSocket(`shell,v2,pty:${t}`))}static async raw(e,t){return new b(await e.createSocket(`shell,v2,raw:${t}`))}#Q;#j;#X;get stdin(){return this.#X}#ee;get stdout(){return this.#ee}#G;get stderr(){return this.#G}#Z=new s.PromiseResolver;get exit(){return this.#Z.promise}constructor(e){let t,r;this.#Q=e,this.#ee=new l.PushReadableStream(e=>{t=e}),this.#G=new l.PushReadableStream(e=>{r=e}),e.readable.pipeThrough(new c.StructDeserializeStream(p)).pipeTo(new u.WritableStream({write:async e=>{switch(e.id){case a.Exit:this.#Z.resolve(e.data[0]);break;case a.Stdout:t.abortSignal.aborted||await t.enqueue(e.data);break;case a.Stderr:r.abortSignal.aborted||await r.enqueue(e.data)}}})).then(()=>{t.close(),r.close(),this.#Z.reject(Error("Socket ended without exit message"))},e=>{t.error(e),r.error(e),this.#Z.reject(e)}),this.#j=this.#Q.writable.getWriter(),this.#X=new o.MaybeConsumable.WritableStream({write:async e=>{await this.#j.write(p.serialize({id:a.Stdin,data:e}))}})}async resize(e,t){await this.#j.write(p.serialize({id:a.WindowSizeChange,data:(0,h.encodeUtf8)(`${e}x${t},0x0\0`)}))}kill(){return this.#Q.close()}}}),a("drR7i",function(t,r){var i,n;e(t.exports,"AdbFeature",()=>i),(n=i||(i={})).ShellV2="shell_v2",n.Cmd="cmd",n.StatV2="stat_v2",n.ListV2="ls_v2",n.FixedPushMkdir="fixed_push_mkdir",n.Abb="abb",n.AbbExec="abb_exec",n.SendReceiveV2="sendrecv_v2",n.DelayedAck="delayed_ack"}),a("cUsti",function(e,t){}),a("beA73",function(t,r){e(t.exports,"escapeArg",()=>i);function i(e){let t="";t+="'";let r=0;for(;;){let i=e.indexOf("'",r);if(-1===i){t+=e.substring(r);break}t+=e.substring(r,i),t+=String.raw`'\''`,r=i+1}return t+"'"}}),a("3HODG",function(t,r){e(t.exports,"AdbSync",()=>n("aBc50").AdbSync),n("9QwYX"),n("6cK2h"),n("awO9J"),n("j6zCo"),n("h4v6J"),n("3JkOU"),n("9for9"),n("aBc50")}),a("9QwYX",function(t,r){e(t.exports,"adbSyncOpenDir",()=>h),n("hr1EK");var i=n("9LJSP"),a=n("j6zCo"),s=n("h4v6J"),o=n("9for9");let l=new(0,i.Struct)({littleEndian:!0}).concat(o.AdbSyncLstatResponse).uint32("nameLength").string("name",{lengthField:"nameLength"}),c=new(0,i.Struct)({littleEndian:!0}).concat(o.AdbSyncStatResponse).uint32("nameLength").string("name",{lengthField:"nameLength"});async function*u(e,t){let r=await e.lock();try{for await(let e of(await (0,a.adbSyncWriteRequest)(r,a.AdbSyncRequestId.ListV2,t),(0,s.adbSyncReadResponses)(r,s.AdbSyncResponseId.Entry2,c)))e.error===o.AdbSyncStatErrorCode.SUCCESS&&(yield e)}finally{r.release()}}async function*d(e,t){let r=await e.lock();try{for await(let e of(await (0,a.adbSyncWriteRequest)(r,a.AdbSyncRequestId.List,t),(0,s.adbSyncReadResponses)(r,s.AdbSyncResponseId.Entry,l)))yield e}finally{r.release()}}async function*h(e,t,r){if(r)yield*u(e,t);else for await(let r of d(e,t))yield{mode:r.mode,size:BigInt(r.size),mtime:BigInt(r.mtime),get type(){return r.type},get permission(){return r.permission},name:r.name}}}),a("j6zCo",function(t,r){e(t.exports,"AdbSyncRequestId",()=>a),e(t.exports,"adbSyncWriteRequest",()=>u),n("hr1EK");var i,a,s=n("9LJSP");n("5lBQi");var o=n("6Savq"),l=n("h4v6J");(i=a||(a={})).List=(0,l.adbSyncEncodeId)("LIST"),i.ListV2=(0,l.adbSyncEncodeId)("LIS2"),i.Send=(0,l.adbSyncEncodeId)("SEND"),i.SendV2=(0,l.adbSyncEncodeId)("SND2"),i.Lstat=(0,l.adbSyncEncodeId)("STAT"),i.Stat=(0,l.adbSyncEncodeId)("STA2"),i.LstatV2=(0,l.adbSyncEncodeId)("LST2"),i.Data=(0,l.adbSyncEncodeId)("DATA"),i.Done=(0,l.adbSyncEncodeId)("DONE"),i.Receive=(0,l.adbSyncEncodeId)("RECV");let c=new(0,s.Struct)({littleEndian:!0}).uint32("id").uint32("arg");async function u(e,t,r){if("string"==typeof t&&(t=(0,l.adbSyncEncodeId)(t)),"number"==typeof r){await e.write(c.serialize({id:t,arg:r}));return}"string"==typeof r&&(r=(0,o.encodeUtf8)(r)),await e.write(c.serialize({id:t,arg:r.length})),await e.write(r)}}),a("h4v6J",function(t,r){e(t.exports,"adbSyncEncodeId",()=>c),e(t.exports,"AdbSyncResponseId",()=>a),e(t.exports,"adbSyncReadResponse",()=>h),e(t.exports,"adbSyncReadResponses",()=>f),n("cOond");var i,a,s=n("h4MAN");n("hr1EK");var o=n("6Savq"),l=n("9LJSP");function c(e){let t=function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t}(e);return(0,s.getUint32LittleEndian)(t,0)}(i=a||(a={})).Entry=c("DENT"),i.Entry2=c("DNT2"),i.Lstat=c("STAT"),i.Stat=c("STA2"),i.Lstat2=c("LST2"),i.Done=c("DONE"),i.Data=c("DATA"),i.Ok=c("OKAY"),i.Fail=c("FAIL");class u extends Error{}let d=new(0,l.Struct)({littleEndian:!0}).uint32("messageLength").string("message",{lengthField:"messageLength"}).postDeserialize(e=>{throw new u(e.message)});async function h(e,t,r){"string"==typeof t&&(t=c(t));let i=await e.readExactly(4);switch((0,s.getUint32LittleEndian)(i,0)){case a.Fail:throw await d.deserialize(e),Error("Unreachable");case t:return await r.deserialize(e);default:throw Error(`Expected '${t}', but got '${(0,o.decodeUtf8)(i)}'`)}}async function*f(e,t,r){for("string"==typeof t&&(t=c(t));;){let i=await e.readExactly(4);switch((0,s.getUint32LittleEndian)(i,0)){case a.Fail:throw await d.deserialize(e),Error("Unreachable");case a.Done:await e.readExactly(r.size);return;case t:yield await r.deserialize(e);break;default:throw Error(`Expected '${t}' or '${a.Done}', but got '${(0,o.decodeUtf8)(i)}'`)}}}}),a("9for9",function(t,r){e(t.exports,"LinuxFileType",()=>s),e(t.exports,"AdbSyncLstatResponse",()=>h),e(t.exports,"AdbSyncStatErrorCode",()=>o),e(t.exports,"AdbSyncStatResponse",()=>f),e(t.exports,"adbSyncLstat",()=>p),e(t.exports,"adbSyncStat",()=>b),n("hr1EK");var i,a,s,o,l=n("9LJSP"),c=n("6Savq"),u=n("j6zCo"),d=n("h4v6J");(i=s||(s={}))[i.Directory=4]="Directory",i[i.File=8]="File",i[i.Link=10]="Link";let h=new(0,l.Struct)({littleEndian:!0}).int32("mode").int32("size").int32("mtime").extra({get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).postDeserialize(e=>{if(0===e.mode&&0===e.size&&0===e.mtime)throw Error("lstat error")});(a=o||(o={}))[a.SUCCESS=0]="SUCCESS",a[a.EACCES=13]="EACCES",a[a.EEXIST=17]="EEXIST",a[a.EFAULT=14]="EFAULT",a[a.EFBIG=27]="EFBIG",a[a.EINTR=4]="EINTR",a[a.EINVAL=22]="EINVAL",a[a.EIO=5]="EIO",a[a.EISDIR=21]="EISDIR",a[a.ELOOP=40]="ELOOP",a[a.EMFILE=24]="EMFILE",a[a.ENAMETOOLONG=36]="ENAMETOOLONG",a[a.ENFILE=23]="ENFILE",a[a.ENOENT=2]="ENOENT",a[a.ENOMEM=12]="ENOMEM",a[a.ENOSPC=28]="ENOSPC",a[a.ENOTDIR=20]="ENOTDIR",a[a.EOVERFLOW=75]="EOVERFLOW",a[a.EPERM=1]="EPERM",a[a.EROFS=30]="EROFS",a[a.ETXTBSY=26]="ETXTBSY";let f=new(0,l.Struct)({littleEndian:!0}).uint32("error",(0,c.placeholder)()).uint64("dev").uint64("ino").uint32("mode").uint32("nlink").uint32("uid").uint32("gid").uint64("size").uint64("atime").uint64("mtime").uint64("ctime").extra({get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).postDeserialize(e=>{if(e.error)throw Error(o[e.error])});async function p(e,t,r){let i=await e.lock();try{if(r)return await (0,u.adbSyncWriteRequest)(i,u.AdbSyncRequestId.LstatV2,t),await (0,d.adbSyncReadResponse)(i,d.AdbSyncResponseId.Lstat2,f);{await (0,u.adbSyncWriteRequest)(i,u.AdbSyncRequestId.Lstat,t);let e=await (0,d.adbSyncReadResponse)(i,d.AdbSyncResponseId.Lstat,h);return{mode:e.mode,size:BigInt(e.size),mtime:BigInt(e.mtime),get type(){return e.type},get permission(){return e.permission}}}}finally{i.release()}}async function b(e,t){let r=await e.lock();try{return await (0,u.adbSyncWriteRequest)(r,u.AdbSyncRequestId.Stat,t),await (0,d.adbSyncReadResponse)(r,d.AdbSyncResponseId.Stat,f)}finally{r.release()}}}),a("6cK2h",function(t,r){e(t.exports,"adbSyncPull",()=>u),n("7edQJ");var i=n("fnPEF");n("hr1EK");var a=n("9LJSP"),s=n("j6zCo"),o=n("h4v6J");let l=new(0,a.Struct)({littleEndian:!0}).uint32("dataLength").uint8Array("data",{lengthField:"dataLength"});async function*c(e,t){let r=await e.lock(),i=!1;try{for await(let e of(await (0,s.adbSyncWriteRequest)(r,s.AdbSyncRequestId.Receive,t),(0,o.adbSyncReadResponses)(r,o.AdbSyncResponseId.Data,l)))yield e.data;i=!0}catch(e){throw i=!0,e}finally{if(!i)for await(let e of(0,o.adbSyncReadResponses)(r,o.AdbSyncResponseId.Data,l));r.release()}}function u(e,t){return new i.PushReadableStream(async r=>{for await(let i of c(e,t))await r.enqueue(i)})}}),a("awO9J",function(t,r){e(t.exports,"adbSyncPush",()=>S),n("7edQJ");var i,a,s=n("6NYMu"),o=n("b5TnZ"),l=n("jEctC");n("hr1EK");var c=n("9LJSP"),u=n("6Savq");n("5lBQi");var d=n("fXuIk"),h=n("j6zCo"),f=n("h4v6J"),p=n("9for9");let b=new(0,c.Struct)({littleEndian:!0}).uint32("unused");async function w(e,t,r,i){let n=new s.AbortController;t.pipeThrough(new o.DistributionStream(r,!0)).pipeTo(new l.MaybeConsumable.WritableStream({write:async t=>{await (0,h.adbSyncWriteRequest)(e,h.AdbSyncRequestId.Data,t)}}),{signal:n.signal}).then(async()=>{await (0,h.adbSyncWriteRequest)(e,h.AdbSyncRequestId.Done,i),await e.flush()},d.NOOP),await (0,f.adbSyncReadResponse)(e,f.AdbSyncResponseId.Ok,b).catch(e=>{throw n.abort(),e})}async function g({socket:e,filename:t,file:r,type:i=p.LinuxFileType.File,permission:n=438,mtime:a=Date.now()/1e3|0,packetSize:s=65536}){let o=await e.lock();try{let e=`${t},${(i<<12|n).toString()}`;await (0,h.adbSyncWriteRequest)(o,h.AdbSyncRequestId.Send,e),await w(o,r,s,a)}finally{o.release()}}(i=a||(a={}))[i.None=0]="None",i[i.Brotli=1]="Brotli",i[i.Lz4=2]="Lz4",i[i.Zstd=4]="Zstd",i[i.DryRun=0x80000000]="DryRun";let y=new(0,c.Struct)({littleEndian:!0}).uint32("id").uint32("mode").uint32("flags",(0,u.placeholder)());async function m({socket:e,filename:t,file:r,type:i=p.LinuxFileType.File,permission:n=438,mtime:s=Date.now()/1e3|0,packetSize:o=65536,dryRun:l=!1}){let c=await e.lock();try{await (0,h.adbSyncWriteRequest)(c,h.AdbSyncRequestId.SendV2,t);let e=a.None;l&&(e|=a.DryRun),await c.write(y.serialize({id:h.AdbSyncRequestId.SendV2,mode:i<<12|n,flags:e})),await w(c,r,o,s)}finally{c.release()}}function S(e){if(e.v2)return m(e);if(e.dryRun)throw Error("dryRun is not supported in v1");return g(e)}}),a("3JkOU",function(t,r){e(t.exports,"AdbSyncSocket",()=>c),n("7edQJ");var i=n("b5TnZ"),a=n("bJSM1"),s=n("5Ywqs");n("5lBQi");var o=n("5SRHv");class l{#j;#a;#et;#er=new o.AutoResetEvent;#ei;get position(){return this.#a.position}constructor(e,t,r,n){this.#j=e,this.#a=t,this.#et=n,this.#ei=new i.BufferCombiner(r)}async #en(e){await (0,s.Consumable).WritableStream.write(this.#j,e)}async flush(){try{await this.#er.wait();let e=this.#ei.flush();e&&await this.#en(e)}finally{this.#er.notifyOne()}}async write(e){try{for(let t of(await this.#er.wait(),this.#ei.push(e)))await this.#en(t)}finally{this.#er.notifyOne()}}async readExactly(e){return await this.flush(),await this.#a.readExactly(e)}release(){this.#ei.flush(),this.#et.notifyOne()}async close(){await this.#a.cancel()}}class c{#ea=new o.AutoResetEvent;#Q;#es;constructor(e,t){this.#Q=e,this.#es=new l(e.writable.getWriter(),new a.BufferedReadableStream(e.readable),t,this.#ea)}async lock(){return await this.#ea.wait(),this.#es}async close(){await this.#es.close(),await this.#Q.close()}}}),a("aBc50",function(t,r){e(t.exports,"AdbSync",()=>h),n("hpom2");var i=n("aGQPd"),a=n("drR7i");n("ezTiR");var s=n("beA73"),o=n("9QwYX"),l=n("6cK2h"),c=n("awO9J"),u=n("3JkOU"),d=n("9for9");class h extends i.AutoDisposable{_adb;_socket;#eo;#el;#ec;#eu;#ed;get supportsStat(){return this.#eo}get supportsListV2(){return this.#el}get fixedPushMkdir(){return this.#ec}get supportsSendReceiveV2(){return this.#eu}get needPushMkdirWorkaround(){return this.#ed}constructor(e,t){super(),this._adb=e,this._socket=new u.AdbSyncSocket(t,e.maxPayloadSize),this.#eo=e.canUseFeature(a.AdbFeature.StatV2),this.#el=e.canUseFeature(a.AdbFeature.ListV2),this.#ec=e.canUseFeature(a.AdbFeature.FixedPushMkdir),this.#eu=e.canUseFeature(a.AdbFeature.SendReceiveV2),this.#ed=this._adb.canUseFeature(a.AdbFeature.ShellV2)&&!this.fixedPushMkdir}async lstat(e){return await (0,d.adbSyncLstat)(this._socket,e,this.#eo)}async stat(e){if(!this.#eo)throw Error("Not supported");return await (0,d.adbSyncStat)(this._socket,e)}async isDirectory(e){try{return await this.lstat(e+"/"),!0}catch(e){return!1}}opendir(e){return(0,o.adbSyncOpenDir)(this._socket,e,this.supportsListV2)}async readdir(e){let t=[];for await(let r of this.opendir(e))t.push(r);return t}read(e){return(0,l.adbSyncPull)(this._socket,e)}async write(e){this.needPushMkdirWorkaround&&await this._adb.subprocess.spawnAndWait(["mkdir","-p",(0,s.escapeArg)(function(e){let t=e.lastIndexOf("/");if(-1===t)throw Error("Invalid path");return 0===t?"/":e.substring(0,t)}(e.filename))]),await (0,c.adbSyncPush)({v2:this.supportsSendReceiveV2,socket:this._socket,...e})}lockSocket(){return this._socket.lock()}async dispose(){super.dispose(),await this._socket.close()}}}),a("liel6",function(t,r){e(t.exports,"AdbTcpIpCommand",()=>a);var i=n("2TOFC");class a extends i.AdbCommandBase{#eh(e){if(e&&"0"!==e)return Number.parseInt(e,10)}async getListenAddresses(){let e=await this.adb.getProp("service.adb.listen_addrs"),t=await this.adb.getProp("service.adb.tcp.port"),r=await this.adb.getProp("persist.adb.tcp.port");return{serviceListenAddresses:""!=e?e.split(","):[],servicePort:this.#eh(t),persistPort:this.#eh(r)}}async setPort(e){if(e<=0)throw TypeError(`Invalid port ${e}`);let t=await this.adb.createSocketAndWait(`tcpip:${e}`);if(t!==`restarting in TCP mode port: ${e}
`)throw Error(t);return t}async disable(){let e=await this.adb.createSocketAndWait("usb:");if("restarting in USB mode\n"!==e)throw Error(e);return e}}}),a("bFpy9",function(t,r){var i,n;e(t.exports,"AdbBanner",()=>a),(n=i||(i={})).Product="ro.product.name",n.Model="ro.product.model",n.Device="ro.product.device",n.Features="features";class a{static parse(e){let t,r,n;let s=[],o=e.split("::");if(o.length>1)for(let e of o[1].split(";")){if(!e)continue;let a=e.split("=");if(2!==a.length)continue;let[o,l]=a;switch(o){case i.Product:t=l;break;case i.Model:r=l;break;case i.Device:n=l;break;case i.Features:s=l.split(",")}}return new a(t,r,n,s)}#ef;get product(){return this.#ef}#ep;get model(){return this.#ep}#r;get device(){return this.#r}#eb=[];get features(){return this.#eb}constructor(e,t,r,i){this.#ef=e,this.#ep=t,this.#r=r,this.#eb=i}}}),a("7gpwK",function(t,r){e(t.exports,"AdbPacketHeader",()=>n("2lmjj").AdbPacketHeader),e(t.exports,"AdbPacketSerializeStream",()=>n("2lmjj").AdbPacketSerializeStream),e(t.exports,"AdbDaemonTransport",()=>n("aIHw7").AdbDaemonTransport),n("gYm23"),n("7qLAG"),n("1hhal"),n("cb2uE"),n("2lmjj"),n("5BaNe"),n("aIHw7")}),a("gYm23",function(t,r){e(t.exports,"ADB_DEFAULT_AUTHENTICATORS",()=>h),e(t.exports,"AdbAuthenticationProcessor",()=>f),n("kV55x");var i,a,s=n("aHKds");n("hr1EK");var o=n("j4unN");n("5lBQi");var l=n("2kccq"),c=n("6Savq"),u=n("7qLAG"),d=n("2lmjj");(i=a||(a={}))[i.Token=1]="Token",i[i.Signature=2]="Signature",i[i.PublicKey=3]="PublicKey";let h=[async function*(e,t){for await(let r of e.iterateKeys()){let e=await t();if(e.arg0!==a.Token)return;let i=(0,u.rsaSign)(r.buffer,e.payload);yield{command:d.AdbCommand.Auth,arg0:a.Signature,arg1:0,payload:i}}},async function*(e,t){let r;if((await t()).arg0!==a.Token)return;for await(let t of e.iterateKeys()){r=t;break}r||(r=await e.generateKey());let i=(0,u.adbGetPublicKeySize)(),[n]=(0,l.calculateBase64EncodedLength)(i),s=r.name?.length?(0,c.encodeUtf8)(r.name):o.EMPTY_UINT8_ARRAY,h=new Uint8Array(n+(s.length?s.length+1:0)+1);(0,u.adbGeneratePublicKey)(r.buffer,h),(0,l.encodeBase64)(h.subarray(0,i),h),s.length&&(h[n]=32,h.set(s,n+1)),yield{command:d.AdbCommand.Auth,arg0:a.PublicKey,arg1:0,payload:h}}];class f{authenticators;#ew;#eg=new s.PromiseResolver;#ey;constructor(e,t){this.authenticators=e,this.#ew=t}#em=()=>this.#eg.promise;async *#eS(){for(let e of this.authenticators)for await(let t of e(this.#ew,this.#em))this.#eg=new s.PromiseResolver,yield t}async process(e){this.#ey||(this.#ey=this.#eS()),this.#eg.resolve(e);let t=await this.#ey.next();if(t.done)throw Error("No authenticator can handle the request");return t.value}dispose(){this.#ey?.return?.()}}}),a("7qLAG",function(t,r){e(t.exports,"adbGetPublicKeySize",()=>u),e(t.exports,"adbGeneratePublicKey",()=>d),e(t.exports,"rsaSign",()=>f),n("cOond");var i=n("jzfEx"),a=n("duafd");function s(e,t,r){let n=0n;for(let a=t;a<t+r;a+=8)n<<=64n,n|=(0,i.getUint64BigEndian)(e,a);return n}function o(e,t,r,i,n){if(n)for(;i>0n;)(0,a.setInt64LittleEndian)(e,t,i),t+=8,i>>=64n;else{let n=t+r-8;for(;i>0n;)(0,a.setInt64BigEndian)(e,n,i),n-=8,i>>=64n}}function l(e){return[s(e,38,256),s(e,303,256)]}function c(e,t){let r=e%t;return r>0?r:r+(t>0?t:-t)}function u(){return 524}function d(e,t){let r;let i=u();if(t){if(t.length<i)throw TypeError("output buffer is too small");r="number"}else t=new Uint8Array(i),r="Uint8Array";let n=new DataView(t.buffer,t.byteOffset,t.length),a=0;n.setUint32(a,64,!0),a+=4;let[s]=l(e),d=-function(e,t){if(!(e=c(e,0x100000000)))return NaN;let r=[],i=0x100000000;for(;i;)[e,i]=[i,e%i],r.push({a:e,b:i});if(1!==e)return NaN;let n=1,a=0;for(let e=r.length-2;e>=0;e-=1)[n,a]=[a,n-a*Math.floor(r[e].a/r[e].b)];return c(a,t)}(Number(s%2n**32n),0x100000000);return(n.setInt32(a,d,!0),o(t,a+=4,256,s,!0),o(t,a+=256,256,2n**4096n%s,!0),a+=256,n.setUint32(a,65537,!0),a+=4,"Uint8Array"===r)?t:i}let h=new Uint8Array([48,33,48,9,6,5,43,14,3,2,26,5,0,4,20]);function f(e,t){let[r,i]=l(e),n=new Uint8Array(256),a=0;n[0]=0,n[a+=1]=1,a+=1;let c=n.length-h.length-t.length-1;for(;a<c;)n[a]=255,a+=1;n[a]=0,a+=1,n.set(h,a),a+=h.length,n.set(t,a);let u=function(e,t,r){if(1n===r)return 0n;let i=1n;for(e%=r;t>0n;)1n===BigInt.asUintN(1,t)&&(i=i*e%r),e=e*e%r,t>>=1n;return i}(s(n,0,n.length),i,r);return o(n,0,n.length,u,!1),n}}),a("2lmjj",function(t,r){e(t.exports,"AdbCommand",()=>a),e(t.exports,"AdbPacketHeader",()=>c),e(t.exports,"calculateChecksum",()=>u),e(t.exports,"AdbPacketSerializeStream",()=>d),n("7edQJ");var i,a,s=n("5Ywqs"),o=n("6NYMu");n("hr1EK");var l=n("9LJSP");(i=a||(a={}))[i.Auth=0x48545541]="Auth",i[i.Close=0x45534c43]="Close",i[i.Connect=0x4e584e43]="Connect",i[i.Okay=0x59414b4f]="Okay",i[i.Open=0x4e45504f]="Open",i[i.Write=0x45545257]="Write";let c=new(0,l.Struct)({littleEndian:!0}).uint32("command").uint32("arg0").uint32("arg1").uint32("payloadLength").uint32("checksum").int32("magic");function u(e){return e.reduce((e,t)=>e+t,0)}new(0,l.Struct)({littleEndian:!0}).concat(c).uint8Array("payload",{lengthField:"payloadLength"});class d extends o.TransformStream{constructor(){let e=new Uint8Array(c.size);super({transform:async(t,r)=>{await t.tryConsume(async t=>{t.payloadLength=t.payload.length,await (0,s.Consumable).ReadableStream.enqueue(r,c.serialize(t,e)),t.payloadLength&&await (0,s.Consumable).ReadableStream.enqueue(r,t.payload)})}})}}}),a("1hhal",function(e,t){}),a("cb2uE",function(t,r){e(t.exports,"AdbPacketDispatcher",()=>p),n("kV55x");var i=n("1PmPk"),a=n("5OCzC"),s=n("aHKds");n("cOond");var o=n("h4MAN");n("7edQJ");var l=n("6NYMu"),c=n("5Ywqs");n("hr1EK");var u=n("6Savq"),d=n("j4unN"),h=n("2lmjj"),f=n("5BaNe");class p{#ev=new i.AsyncOperationManager(1);#ex=new Map;#j;options;#M=!1;#eE=new s.PromiseResolver;get disconnected(){return this.#eE.promise}#eA=new Map;#ek=new l.AbortController;constructor(e,t){this.options=t,this.options.initialDelayedAckBytes<0&&(this.options.initialDelayedAckBytes=0),e.readable.pipeTo(new l.WritableStream({write:async e=>{switch(e.command){case h.AdbCommand.Close:await this.#eI(e);break;case h.AdbCommand.Okay:this.#eR(e);break;case h.AdbCommand.Open:await this.#eC(e);break;case h.AdbCommand.Write:await this.#eT(e);break;default:throw Error(`Unknown command: ${e.command.toString(16)}`)}}}),{preventCancel:t.preserveConnection??!1,signal:this.#ek.signal}).then(()=>{this.#eP()},e=>{this.#M||this.#eE.reject(e),this.#eP()}),this.#j=e.writable.getWriter()}async #eI(e){if(0===e.arg0&&this.#ev.reject(e.arg1,Error("Socket open failed")))return;let t=this.#ex.get(e.arg1);if(t){await t.close(),t.dispose(),this.#ex.delete(e.arg1);return}}#eR(e){let t;if(0!==this.options.initialDelayedAckBytes){if(4!==e.payload.length)throw Error("Invalid OKAY packet. Payload size should be 4");t=(0,o.getUint32LittleEndian)(e.payload,0)}else{if(0!==e.payload.length)throw Error("Invalid OKAY packet. Payload size should be 0");t=1/0}if(this.#ev.resolve(e.arg1,{remoteId:e.arg0,availableWriteBytes:t}))return;let r=this.#ex.get(e.arg1);if(r){r.ack(t);return}this.sendPacket(h.AdbCommand.Close,e.arg1,e.arg0,d.EMPTY_UINT8_ARRAY)}#eN(e,t,r){let i;return 0!==this.options.initialDelayedAckBytes?(i=new Uint8Array(4),(0,o.setUint32LittleEndian)(i,0,r)):i=d.EMPTY_UINT8_ARRAY,this.sendPacket(h.AdbCommand.Okay,e,t,i)}async #eC(e){let[t]=this.#ev.add();this.#ev.resolve(t,void 0);let r=e.arg0,i=e.arg1,n=(0,u.decodeUtf8)(e.payload);if(n.endsWith("\0")&&(n=n.substring(0,n.length-1)),0===this.options.initialDelayedAckBytes){if(0!==i)throw Error("Invalid OPEN packet. arg1 should be 0");i=1/0}else if(0===i)throw Error("Invalid OPEN packet. arg1 should be greater than 0");let a=this.#eA.get(n);if(!a){await this.sendPacket(h.AdbCommand.Close,0,r,d.EMPTY_UINT8_ARRAY);return}let s=new f.AdbDaemonSocketController({dispatcher:this,localId:t,remoteId:r,localCreated:!1,service:n,availableWriteBytes:i});try{await a(s.socket),this.#ex.set(t,s),await this.#eN(t,r,this.options.initialDelayedAckBytes)}catch(e){await this.sendPacket(h.AdbCommand.Close,0,r,d.EMPTY_UINT8_ARRAY)}}async #eT(e){let t=this.#ex.get(e.arg1);if(!t)throw Error(`Unknown local socket id: ${e.arg1}`);let r=!1,i=[(async()=>{await t.enqueue(e.payload),await this.#eN(e.arg1,e.arg0,e.payload.length),r=!0})()];this.options.readTimeLimit&&i.push((async()=>{if(await (0,a.delay)(this.options.readTimeLimit),!r)throw Error(`readable of \`${t.service}\` has stalled for ${this.options.readTimeLimit} milliseconds`)})()),await Promise.race(i)}async createSocket(e){this.options.appendNullToServiceString&&(e+="\0");let[t,r]=this.#ev.add();await this.sendPacket(h.AdbCommand.Open,t,this.options.initialDelayedAckBytes,e);let{remoteId:i,availableWriteBytes:n}=await r,a=new f.AdbDaemonSocketController({dispatcher:this,localId:t,remoteId:i,localCreated:!0,service:e,availableWriteBytes:n});return this.#ex.set(t,a),a.socket}addReverseTunnel(e,t){this.#eA.set(e,t)}removeReverseTunnel(e){this.#eA.delete(e)}clearReverseTunnels(){this.#eA.clear()}async sendPacket(e,t,r,i){if("string"==typeof i&&(i=(0,u.encodeUtf8)(i)),i.length>this.options.maxPayloadSize)throw TypeError("payload too large");await (0,c.Consumable).WritableStream.write(this.#j,{command:e,arg0:t,arg1:r,payload:i,checksum:this.options.calculateChecksum?(0,h.calculateChecksum)(i):0,magic:0xffffffff^e})}async close(){await Promise.all(Array.from(this.#ex.values(),e=>e.close())),this.#M=!0,this.#ek.abort(),this.options.preserveConnection?this.#j.releaseLock():await this.#j.close()}#eP(){for(let e of this.#ex.values())e.dispose();this.#eE.resolve()}}}),a("5BaNe",function(t,r){e(t.exports,"AdbDaemonSocketController",()=>c),n("kV55x");var i=n("aHKds");n("7edQJ");var a=n("jEctC"),s=n("fnPEF");n("hr1EK");var o=n("j4unN"),l=n("2lmjj");class c{#eF;localId;remoteId;localCreated;service;#a;#F;get readable(){return this.#a}#eD;writable;#M=!1;#eB=new i.PromiseResolver;get closed(){return this.#eB.promise}#Q;get socket(){return this.#Q}#eL;#ez=0;constructor(e){this.#eF=e.dispatcher,this.localId=e.localId,this.remoteId=e.remoteId,this.localCreated=e.localCreated,this.service=e.service,this.#a=new s.PushReadableStream(e=>{this.#F=e}),this.writable=new a.MaybeConsumable.WritableStream({start:e=>{this.#eD=e,e.signal.addEventListener("abort",()=>{this.#eL?.reject(e.signal.reason)})},write:async e=>{let t=e.length,r=this.#eF.options.maxPayloadSize;for(let i=0,n=r;i<t;i=n,n+=r){let t=e.subarray(i,n);await this.#eU(t)}}}),this.#Q=new u(this),this.#ez=e.availableWriteBytes}async #eU(e){let t=e.length;for(;this.#ez<t;){let e=new i.PromiseResolver;this.#eL=e,await e.promise}this.#ez===1/0?this.#ez=-1:this.#ez-=t,await this.#eF.sendPacket(l.AdbCommand.Write,this.localId,this.remoteId,e)}async enqueue(e){if(!this.#F.abortSignal.aborted)try{await this.#F.enqueue(e)}catch(e){if(this.#F.abortSignal.aborted)return;throw e}}ack(e){this.#ez+=e,this.#eL?.resolve()}async close(){if(!this.#M){this.#M=!0,this.#eL?.reject(Error("Socket closed"));try{this.#eD.error(Error("Socket closed"))}catch{}await this.#eF.sendPacket(l.AdbCommand.Close,this.localId,this.remoteId,o.EMPTY_UINT8_ARRAY)}}dispose(){try{this.#F.close()}catch{}this.#eB.resolve()}}class u{#eO;get localId(){return this.#eO.localId}get remoteId(){return this.#eO.remoteId}get localCreated(){return this.#eO.localCreated}get service(){return this.#eO.service}get readable(){return this.#eO.readable}get writable(){return this.#eO.writable}get closed(){return this.#eO.closed}constructor(e){this.#eO=e}close(){return this.#eO.close()}}}),a("aIHw7",function(t,r){e(t.exports,"AdbDaemonTransport",()=>p),n("kV55x");var i=n("aHKds");n("7edQJ");var a=n("6NYMu"),s=n("5Ywqs");n("hr1EK");var o=n("6Savq"),l=n("bFpy9"),c=n("drR7i"),u=n("gYm23"),d=n("cb2uE"),h=n("2lmjj");let f=[c.AdbFeature.ShellV2,c.AdbFeature.Cmd,c.AdbFeature.StatV2,c.AdbFeature.ListV2,c.AdbFeature.FixedPushMkdir,"apex",c.AdbFeature.Abb,"fixed_push_symlink_timestamp",c.AdbFeature.AbbExec,"remount_shell","track_app",c.AdbFeature.SendReceiveV2,"sendrecv_v2_brotli","sendrecv_v2_lz4","sendrecv_v2_zstd","sendrecv_v2_dry_run_send",c.AdbFeature.DelayedAck];class p{static async authenticate({serial:e,connection:t,credentialStore:r,authenticators:n=u.ADB_DEFAULT_AUTHENTICATORS,features:l=f,initialDelayedAckBytes:d=0x2000000,...b}){let w,g=0x1000001,y=1048576,m=new i.PromiseResolver,S=new u.AdbAuthenticationProcessor(n,r),v=new a.AbortController,x=t.readable.pipeTo(new a.WritableStream({async write(e){switch(e.command){case h.AdbCommand.Connect:g=Math.min(g,e.arg0),y=Math.min(y,e.arg1),m.resolve((0,o.decodeUtf8)(e.payload));break;case h.AdbCommand.Auth:{let t=await S.process(e);await A(t)}}}}),{preventCancel:!0,signal:v.signal}).then(()=>{m.reject(Error("Connection closed unexpectedly"))},e=>{m.reject(e)}),E=t.writable.getWriter();async function A(e){e.checksum=(0,h.calculateChecksum)(e.payload),e.magic=0xffffffff^e.command,await (0,s.Consumable).WritableStream.write(E,e)}let k=l.slice();if(d<=0){let e=l.indexOf(c.AdbFeature.DelayedAck);-1!==e&&k.splice(e,1)}try{await A({command:h.AdbCommand.Connect,arg0:g,arg1:y,payload:(0,o.encodeUtf8)(`host::features=${k.join(",")}`)}),w=await m.promise}finally{v.abort(),E.releaseLock(),await x}return new p({serial:e,connection:t,version:g,maxPayloadSize:y,banner:w,features:k,initialDelayedAckBytes:d,...b})}#e_;get connection(){return this.#e_}#eF;#d;get serial(){return this.#d}#eV;get protocolVersion(){return this.#eV}get maxPayloadSize(){return this.#eF.options.maxPayloadSize}#eM;get banner(){return this.#eM}get disconnected(){return this.#eF.disconnected}#eW;get clientFeatures(){return this.#eW}constructor({serial:e,connection:t,version:r,banner:i,features:n=f,initialDelayedAckBytes:a,...s}){let o,u;if(this.#d=e,this.#e_=t,this.#eM=(0,l.AdbBanner).parse(i),this.#eW=n,n.includes(c.AdbFeature.DelayedAck)){if(a<=0)throw TypeError("`initialDelayedAckBytes` must be greater than 0 when DelayedAck feature is enabled.");this.#eM.features.includes(c.AdbFeature.DelayedAck)||(a=0)}else a=0;r>=0x1000001?(o=!1,u=!1):(o=!0,u=!0),this.#eF=new d.AdbPacketDispatcher(t,{calculateChecksum:o,appendNullToServiceString:u,initialDelayedAckBytes:a,...s}),this.#eV=r}connect(e){return this.#eF.createSocket(e)}addReverseTunnel(e,t){if(!t){let e=Math.random().toString().substring(2);t=`localabstract:reverse_${e}`}return this.#eF.addReverseTunnel(t,e),t}removeReverseTunnel(e){this.#eF.removeReverseTunnel(e)}clearReverseTunnels(){this.#eF.clearReverseTunnels()}close(){return this.#eF.close()}}}),a("jBeoN",function(e,t){n("iHRUW"),n("btVdk")}),a("iHRUW",function(e,t){n("kV55x");var r,i=n("aHKds");n("cOond");var a=n("jzfEx");n("7edQJ");var s=n("bJSM1"),o=n("jEctC"),l=n("67qk3");n("hr1EK");var c=n("6Savq"),u=n("j4unN"),d=n("6yg6p"),h=n("bFpy9");n("5lBQi");var f=n("32bmk"),p=n("fXuIk"),b=n("gtlgZ"),w=n("btVdk");let g=(0,c.encodeUtf8)("OKAY"),y=(0,c.encodeUtf8)("FAIL");class m{#e_;#A;#j;constructor(e){this.#e_=e,this.#A=new s.BufferedReadableStream(e.readable),this.#j=e.writable.getWriter()}readExactly(e){return this.#A.readExactly(e)}readString(){return(0,d.SyncPromise).try(()=>this.readExactly(4)).then(e=>{let t=(0,f.hexToNumber)(e);return 0===t?u.EMPTY_UINT8_ARRAY:this.readExactly(t)}).then(e=>(0,c.decodeUtf8)(e)).valueOrPromise()}async writeString(e){let t=(0,c.encodeUtf8)(e),r=new Uint8Array(4+t.length);(0,f.write4HexDigits)(r,0,t.length),r.set(t,4),await this.#j.write(r)}async readOkay(){let e=await this.readExactly(4);if(!(0,b.sequenceEqual)(e,g)){if((0,b.sequenceEqual)(e,y))throw Error(await this.readString());throw Error(`Unexpected response: ${(0,c.decodeUtf8)(e)}`)}}release(){return this.#j.releaseLock(),{readable:this.#A.release(),writable:this.#e_.writable,closed:this.#e_.closed,close:()=>this.#e_.close()}}async dispose(){await this.#A.cancel().catch(p.NOOP),await this.#j.close().catch(p.NOOP);try{await this.#e_.close()}catch{}}}class S{static VERSION=41;connector;wireless=new S.WirelessCommands(this);mDns=new S.MDnsCommands(this);constructor(e){this.connector=e}async createConnection(e,t){let r=new m(await this.connector.connect(t));try{await r.writeString(e)}catch(e){throw await r.dispose(),e}try{return await v(()=>r.readOkay(),t?.signal),r}catch(e){throw await r.dispose(),e}}async getVersion(){let e=await this.createConnection("host:version");try{let t=(0,f.hexToNumber)(await e.readExactly(4));return(0,f.hexToNumber)(await e.readExactly(t))}finally{await e.dispose()}}async validateVersion(){let e=await this.getVersion();if(e!==S.VERSION)throw Error(`adb server version (${e}) doesn't match this client (${S.VERSION})`)}async killServer(){let e=await this.createConnection("host:kill");await e.dispose()}async getServerFeatures(){let e=await this.createConnection("host:host-features");try{return(await e.readString()).split(",")}finally{await e.dispose()}}parseDeviceList(e){let t=[];for(let r of e.split("\n")){let e,i,n,a;if(!r)continue;let s=r.split(" ").filter(Boolean),o=s[0],l=s[1];if("device"===l||"unauthorized"===l){for(let t=2;t<s.length;t+=1){let[r,o]=s[t].split(":");switch(r){case"product":e=o;break;case"model":i=o;break;case"device":n=o;break;case"transport_id":a=BigInt(o)}}if(!a)throw Error(`No transport id for device ${o}`);t.push({serial:o,authenticating:"unauthorized"===l,product:e,model:i,device:n,transportId:a})}}return t}async getDevices(){let e=await this.createConnection("host:devices-l");try{let t=await e.readString();return this.parseDeviceList(t)}finally{await e.dispose()}}async *trackDevices(e){let t=await this.createConnection("host:track-devices-l");try{for(;;){let r=await v(async()=>await t.readString(),e),i=this.parseDeviceList(r);yield i}}catch(t){if(t===e?.reason)return}finally{await t.dispose()}}formatDeviceService(e,t){if(!e)return`host:${t}`;if("transportId"in e)return`host-transport-id:${e.transportId}:${t}`;if("serial"in e)return`host-serial:${e.serial}:${t}`;if("usb"in e)return`host-usb:${t}`;if("tcp"in e)return`host-local:${t}`;throw TypeError("Invalid device selector")}async reconnectDevice(e){let t=await this.createConnection("offline"===e?"host:reconnect-offline":this.formatDeviceService(e,"reconnect"));try{await t.readString()}finally{await t.dispose()}}async getDeviceFeatures(e){let t=await this.createDeviceConnection(e,"host:features"),r=new m(t);try{let e=(await r.readString()).split(",");return{transportId:t.transportId,features:e}}finally{await r.dispose()}}async createDeviceConnection(e,t){let r,i;if(await this.validateVersion(),e){if("transportId"in e)r=`host:transport-id:${e.transportId}`,i=e.transportId;else if("serial"in e)r=`host:tport:serial:${e.serial}`;else if("usb"in e)r="host:tport:usb";else if("tcp"in e)r="host:tport:local";else throw TypeError("Invalid device selector")}else r="host:tport:any";let n=await this.createConnection(r);try{await n.writeString(t)}catch(e){throw await n.dispose(),e}try{if(void 0===i){let e=await n.readExactly(8);i=(0,a.getUint64LittleEndian)(e,0)}await n.readOkay();let e=n.release();return{transportId:i,service:t,readable:e.readable,writable:new(0,l.WrapWritableStream)(e.writable).bePipedThroughFrom(new o.MaybeConsumable.UnwrapStream),get closed(){return e.closed},async close(){await e.close()}}}catch(e){throw await n.dispose(),e}}async waitFor(e,t,r){let i;if(e){if("transportId"in e)i="any";else if("serial"in e)i="any";else if("usb"in e)i="usb";else if("tcp"in e)i="local";else throw TypeError("Invalid device selector")}else i="any";let n=this.formatDeviceService(e,`wait-for-${i}-${t}`),a=await this.createConnection(n,r);try{await a.readOkay()}finally{await a.dispose()}}async createTransport(e){let{transportId:t,features:r}=await this.getDeviceFeatures(e),i=(await this.getDevices()).find(e=>e.transportId===t),n=new h.AdbBanner(i?.product,i?.model,i?.device,r);return new w.AdbServerTransport(this,i?.serial??"",n,t)}}async function v(e,...t){let r=new i.PromiseResolver;function n(){r.reject(this.reason)}try{for(let e of t)if(e){if(e.aborted)throw e.reason;e.addEventListener("abort",n)}return await Promise.race([e(),r.promise])}finally{for(let e of t)e&&e.removeEventListener("abort",n)}}(r=S||(S={})).NetworkError=class extends Error{constructor(e){super(e),this.name="NetworkError"}},r.UnauthorizedError=class extends Error{constructor(e){super(e),this.name="UnauthorizedError"}},r.AlreadyConnectedError=class extends Error{constructor(e){super(e),this.name="AlreadyConnectedError"}},r.WirelessCommands=class{#eq;constructor(e){this.#eq=e}async pair(e,t){let r=await this.#eq.createConnection(`host:pair:${t}:${e}`);try{let e=await r.readExactly(4);if((0,b.sequenceEqual)(e,y))throw Error(await r.readString());let t=(0,f.hexToNumber)(e);await r.readExactly(t)}finally{await r.dispose()}}async connect(e){let t=await this.#eq.createConnection(`host:connect:${e}`);try{let i=await t.readString();switch(i){case`already connected to ${e}`:throw new r.AlreadyConnectedError(i);case`failed to connect to ${e}`:case`failed to authenticate to ${e}`:throw new r.UnauthorizedError(i);case`connected to ${e}`:return;default:throw new r.NetworkError(i)}}finally{await t.dispose()}}async disconnect(e){let t=await this.#eq.createConnection(`host:disconnect:${e}`);try{await t.readString()}finally{await t.dispose()}}},r.MDnsCommands=class{#eq;constructor(e){this.#eq=e}async check(){let e=await this.#eq.createConnection("host:mdns:check");try{return!(await e.readString()).startsWith("ERROR:")}finally{await e.dispose()}}async getServices(){let e=await this.#eq.createConnection("host:mdns:services");try{return(await e.readString()).split("\n").filter(Boolean).map(e=>{let t=e.split("	");return{name:t[0],service:t[1],address:t[2]}})}finally{await e.dispose()}}}}),a("btVdk",function(t,r){e(t.exports,"AdbServerTransport",()=>l),n("kV55x");var i=n("aHKds");n("7edQJ");var a=n("6NYMu"),s=n("drR7i");let o=[s.AdbFeature.ShellV2,s.AdbFeature.Cmd,s.AdbFeature.StatV2,s.AdbFeature.ListV2,s.AdbFeature.FixedPushMkdir,"apex",s.AdbFeature.Abb,"fixed_push_symlink_timestamp",s.AdbFeature.AbbExec,"remount_shell","track_app",s.AdbFeature.SendReceiveV2,"sendrecv_v2_brotli","sendrecv_v2_lz4","sendrecv_v2_zstd","sendrecv_v2_dry_run_send"];class l{#eq;serial;transportId;maxPayloadSize=1048576;banner;#M=new i.PromiseResolver;#ej=new a.AbortController;disconnected;get clientFeatures(){return o}constructor(e,t,r,i){this.#eq=e,this.serial=t,this.banner=r,this.transportId=i,this.disconnected=Promise.race([this.#M.promise,e.waitFor({transportId:i},"disconnect",{signal:this.#ej.signal,unref:!0})])}async connect(e){return await this.#eq.createDeviceConnection({transportId:this.transportId},e)}async addReverseTunnel(e,t){return await this.#eq.connector.addReverseTunnel(e,t)}async removeReverseTunnel(e){await this.#eq.connector.removeReverseTunnel(e)}async clearReverseTunnels(){await this.#eq.connector.clearReverseTunnels()}close(){this.#M.resolve(),this.#ej.abort()}}}),a("byTpg",function(t,r){function i(e,t){return"object"==typeof e&&null!==e&&"name"in e&&e.name===t}function n(e,t){for(let r of e.configurations)for(let e of r.interfaces)for(let i of e.alternates)if(function(e,t){return t.some(t=>e.interfaceClass===t.classCode&&e.interfaceSubclass===t.subclassCode&&e.interfaceProtocol===t.protocolCode)}(i,t))return{configuration:r,interface_:e,alternate:i};throw TypeError("No matched alternate interface found")}function a(e){return e.toString(16).padStart(4,"0")}function s(e){return e.serialNumber?e.serialNumber:a(e.vendorId)+"x"+a(e.productId)}e(t.exports,"isErrorName",()=>i),e(t.exports,"findUsbAlternateInterface",()=>n),e(t.exports,"getSerialNumber",()=>s)}),a("aI8PJ",function(t,r){e(t.exports,"AdbDaemonWebUsbDeviceManager",()=>s);var i=n("dGdCH"),a=n("byTpg");class s{static BROWSER=void 0!==globalThis.navigator&&globalThis.navigator.usb?new s(globalThis.navigator.usb):void 0;#c;constructor(e){this.#c=e}async requestDevice(e={}){if(e.filters){if(0===e.filters.length)throw TypeError("filters must not be empty")}else e.filters=[i.ADB_DEFAULT_DEVICE_FILTER];try{let t=await this.#c.requestDevice(e);return new i.AdbDaemonWebUsbDevice(t,e.filters,this.#c)}catch(e){if((0,a.isErrorName)(e,"NotFoundError"))return;throw e}}async getDevices(e=[i.ADB_DEFAULT_DEVICE_FILTER]){if(0===e.length)throw TypeError("filters must not be empty");return(await this.#c.getDevices()).filter(t=>{for(let r of e)if((!("vendorId"in r)||t.vendorId===r.vendorId)&&(!("productId"in r)||t.productId===r.productId)&&(!("serialNumber"in r)||(0,a.getSerialNumber)(t)===r.serialNumber))try{return(0,a.findUsbAlternateInterface)(t,e),!0}catch{continue}return!1}).map(t=>new i.AdbDaemonWebUsbDevice(t,e,this.#c))}}}),a("7wgv6",function(e,t){}),a("jhyqS",function(t,r){function i(){return new Promise((e,t)=>{let r=indexedDB.open("Tango",1);r.onerror=()=>{t(r.error)},r.onupgradeneeded=()=>{r.result.createObjectStore("Authentication",{autoIncrement:!0})},r.onsuccess=()=>{e(r.result)}})}async function n(e){let t=await i();return new Promise((r,i)=>{let n=t.transaction("Authentication","readwrite"),a=n.objectStore("Authentication").add(e);a.onerror=()=>{i(a.error)},a.onsuccess=()=>{r()},n.onerror=()=>{i(n.error)},n.oncomplete=()=>{t.close()}})}async function a(){let e=await i();return new Promise((t,r)=>{let i=e.transaction("Authentication","readonly"),n=i.objectStore("Authentication").getAll();n.onerror=()=>{r(n.error)},n.onsuccess=()=>{t(n.result)},i.onerror=()=>{r(i.error)},i.oncomplete=()=>{e.close()}})}e(t.exports,"default",()=>s);class s{#eY;constructor(e="Tango"){this.#eY=e}async generateKey(){let{privateKey:e}=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-1"},!0,["sign","verify"]),t=new Uint8Array(await crypto.subtle.exportKey("pkcs8",e));return await n(t),{buffer:t,name:`${this.#eY}@${globalThis.location.hostname}`}}async *iterateKeys(){for(let e of(await a()))yield{buffer:e,name:`${this.#eY}@${globalThis.location.hostname}`}}}});
//# sourceMappingURL=index.44060ccf.js.map
